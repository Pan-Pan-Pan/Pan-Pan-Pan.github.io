<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>面向对象的程序设计 | Riccardo's Blog</title><meta name="author" content="Chou,1425650574@qq.com"><meta name="copyright" content="Chou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="面向对象的程序设计一、Java 语言1. Java 的特点 面向对象  两个基本概念：类、对象 三大特性：封装、继承、多态   健壮性 吸收了 C&#x2F;C++ 语言的优点，但是去掉了指针、内存的申请和释放等影响程序健壮性的部分，提供了一个相对安全的的内存管理和访问机制。  跨平台性 Write once, run anywhere. 由 JVM 来负责 Java 程序在不同系统上的运行。">
<meta property="og:type" content="article">
<meta property="og:title" content="面向对象的程序设计">
<meta property="og:url" content="http://example.com/2023/01/07/OOP/index.html">
<meta property="og:site_name" content="Riccardo&#39;s Blog">
<meta property="og:description" content="面向对象的程序设计一、Java 语言1. Java 的特点 面向对象  两个基本概念：类、对象 三大特性：封装、继承、多态   健壮性 吸收了 C&#x2F;C++ 语言的优点，但是去掉了指针、内存的申请和释放等影响程序健壮性的部分，提供了一个相对安全的的内存管理和访问机制。  跨平台性 Write once, run anywhere. 由 JVM 来负责 Java 程序在不同系统上的运行。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/Pan-Pan-Pan/AssetsForBlog/tree/main/global/background.jpg">
<meta property="article:published_time" content="2023-01-07T07:49:50.000Z">
<meta property="article:modified_time" content="2023-01-07T09:24:56.475Z">
<meta property="article:author" content="Chou">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/Pan-Pan-Pan/AssetsForBlog/tree/main/global/background.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/01/07/OOP/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '面向对象的程序设计',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2023-01-07 17:24:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://github.com/Pan-Pan-Pan/AssetsForBlog/tree/main/global/img.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">1</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://github.com/Pan-Pan-Pan/AssetsForBlog/tree/main/global/background.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Riccardo's Blog</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">面向对象的程序设计</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-01-07T07:49:50.000Z" title="发表于 2023-01-07 15:49:50">2023-01-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-01-07T09:24:56.475Z" title="更新于 2023-01-07 17:24:56">2023-01-07</time></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="面向对象的程序设计"><a href="#面向对象的程序设计" class="headerlink" title="面向对象的程序设计"></a>面向对象的程序设计</h1><h2 id="一、Java-语言"><a href="#一、Java-语言" class="headerlink" title="一、Java 语言"></a>一、Java 语言</h2><h3 id="1-Java-的特点"><a href="#1-Java-的特点" class="headerlink" title="1. Java 的特点"></a>1. Java 的特点</h3><ul>
<li><p><strong>面向对象</strong></p>
<ul>
<li>两个基本概念：类、对象</li>
<li>三大特性：封装、继承、多态</li>
</ul>
</li>
<li><p><strong>健壮性</strong></p>
<p>吸收了 C&#x2F;C++ 语言的优点，但是去掉了指针、内存的申请和释放等影响程序健壮性的部分，提供了一个<strong>相对安全的的内存管理和访问机制</strong>。</p>
</li>
<li><p><strong>跨平台性</strong></p>
<p><strong>Write once, run anywhere.</strong> 由 JVM 来负责 Java 程序在不同系统上的运行。</p>
</li>
</ul>
<h3 id="2-Java-虚拟机"><a href="#2-Java-虚拟机" class="headerlink" title="2. Java 虚拟机"></a>2. Java 虚拟机</h3><ul>
<li><strong>JVM 是一个虚拟的计算机</strong>，具有指令集并使用不同的存储区域，负责执行指令，管理数据、内存、寄存器。</li>
<li>不同平台对应的 JVM 也不同。只要某平台提供了对应的 Java 虚拟机，Java 程序就可以在此平台运行。</li>
<li><strong>Java 虚拟机机制屏蔽了底层运行平台的差异。</strong></li>
</ul>
<h3 id="3-垃圾回收机制"><a href="#3-垃圾回收机制" class="headerlink" title="3. 垃圾回收机制"></a>3. 垃圾回收机制</h3><ul>
<li>Java 提供了一种<strong>系统级线程跟踪存储空间分配情况</strong>的手段，在 JVM 空闲时，检查并释放那些可被释放的内存空间。</li>
<li>垃圾回收在 Java 程序运行过程中<strong>自动进行</strong>，程序员无法精确控制和干预。</li>
<li>即便如此，Java 程序仍<strong>可能会出现内存泄漏和溢出的问题</strong>。</li>
</ul>
<h3 id="4-JRE-和-JDK"><a href="#4-JRE-和-JDK" class="headerlink" title="4. JRE 和 JDK"></a>4. JRE 和 JDK</h3><ul>
<li><strong>Java Runtime Environment（ JRE，Java 运行环境）&#x3D;  JVM + Java SE 标准类库</strong></li>
<li><strong>Java Development Kit（ JDK，Java 开发工具包） &#x3D;  JRE + 开发工具集（如 javac 编译工具等）</strong></li>
</ul>
<h3 id="5-Java-关键字"><a href="#5-Java-关键字" class="headerlink" title="5. Java 关键字"></a>5. Java 关键字</h3><table>
<thead>
<tr>
<th>类别</th>
<th>关键字</th>
</tr>
</thead>
<tbody><tr>
<td>量</td>
<td><code>true</code> <code>false</code> <code>null</code> <code>this</code> <code>super</code></td>
</tr>
<tr>
<td>运算</td>
<td><code>new</code> <code>instanceof</code></td>
</tr>
<tr>
<td>类型</td>
<td><code>boolean</code>  <code>byte</code> <code>char</code> <code>short</code> <code>int</code> <code>long</code> <code>float</code> <code>double</code> <code>void</code> <code>class</code> <code>interface</code> <code>enum</code></td>
</tr>
<tr>
<td>控制</td>
<td><code>if</code> <code>else</code> <code>switch</code> <code>case</code> <code>default</code> <code>for</code> <code>do</code> <code>while</code> <code>continue</code> <code>break</code> <code>return</code></td>
</tr>
<tr>
<td>修饰</td>
<td><code>private</code> <code>protected</code> <code>public</code> <code>abstract</code> <code>static</code> <code>final</code> <code>synchronized</code> <code>strictfp</code> <code>native</code> <code>transient</code> <code>volatile</code></td>
</tr>
<tr>
<td>声明</td>
<td><code>package</code> <code>import</code> <code>extends</code> <code>implements</code></td>
</tr>
<tr>
<td>异常</td>
<td><code>try</code> <code>catch</code> <code>finally</code> <code>throws</code> <code>throw</code></td>
</tr>
<tr>
<td>调试</td>
<td><code>assert</code></td>
</tr>
<tr>
<td>保留</td>
<td><code>const</code> <code>goto</code></td>
</tr>
</tbody></table>
<h2 id="二、类和对象"><a href="#二、类和对象" class="headerlink" title="二、类和对象"></a>二、类和对象</h2><h3 id="1-类"><a href="#1-类" class="headerlink" title="1. 类"></a>1. 类</h3><ul>
<li><strong>类是一个模板。</strong>类定义了一类事物的状态和行为。</li>
<li>类是对现实世界的抽象，<strong>类是一种抽象的复合数据类型。</strong></li>
</ul>
<h3 id="2-类和对象的关系"><a href="#2-类和对象的关系" class="headerlink" title="2. 类和对象的关系"></a>2. 类和对象的关系</h3><ul>
<li>类和对象之间是抽象和具体的关系。<strong>类是创建对象的模板，对象是类的具体实例。</strong></li>
<li>class 是总称，object 是个体。object 也叫 instance（实例）。</li>
</ul>
<h3 id="3-消息"><a href="#3-消息" class="headerlink" title="3. 消息"></a>3. 消息</h3><ul>
<li>对象提供的服务是由对象的函数来实现的。<strong>发送消息实际上就是调用一个对象的函数。</strong></li>
</ul>
<h3 id="4-成员"><a href="#4-成员" class="headerlink" title="4. 成员"></a>4. 成员</h3><ul>
<li>类的成员变量可以是基本类型或数组，也可以是类的对象。</li>
<li>类的成员函数用于处理该类的数据，是用户和对象之间或对象之间的交互接口。</li>
</ul>
<h3 id="5-类之间的关系"><a href="#5-类之间的关系" class="headerlink" title="5. 类之间的关系"></a>5. 类之间的关系</h3><ul>
<li><p><strong>关联（Association）</strong></p>
<blockquote>
<p>关联指的是类之间的特定对应关系。</p>
</blockquote>
<ul>
<li>一对一关联</li>
<li>一对多关联</li>
<li>多对多关联</li>
</ul>
</li>
<li><p><strong>依赖（Dependency）</strong></p>
<blockquote>
<p>依赖指的是类之间的调用关系。如果类 A 访问类 B 的成员，或者 A 负责实例化 B，那么可以说类 A 依赖类 B。</p>
</blockquote>
</li>
<li><p><strong>聚集（Aggression）</strong></p>
<blockquote>
<p>聚集指的是整体与部分之间的关系。</p>
</blockquote>
</li>
<li><p><strong>泛化（Generalization）</strong></p>
<blockquote>
<p>泛化指的是类之间的继承关系。</p>
</blockquote>
</li>
<li><p><strong>实现（Realization）</strong></p>
<blockquote>
<p>实现指的是类与接口之间的关系。</p>
</blockquote>
</li>
</ul>
<h2 id="三、封装"><a href="#三、封装" class="headerlink" title="三、封装"></a>三、封装</h2><h3 id="1-数据类型"><a href="#1-数据类型" class="headerlink" title="1. 数据类型"></a>1. 数据类型</h3><p><img src="https://github.com/Pan-Pan-Pan/AssetsForBlog/tree/main/OOP/1.png"></p>
<h3 id="2-变量"><a href="#2-变量" class="headerlink" title="2. 变量"></a>2. 变量</h3><ul>
<li><p><strong>概念</strong></p>
<ul>
<li>内存中的一个<strong>存储区域</strong>，该区域拥有自己的<strong>名称和类型</strong>。</li>
<li>Java 是<strong>强类型语言</strong>，变量必须先定义、后使用。</li>
<li><strong>变量是通过变量名访问该区域的。</strong></li>
<li>变量的作用域：一对${ }$之间有效。</li>
</ul>
</li>
<li><p><strong>定义</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Type name [= initValue];</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>分类</strong></p>
<ul>
<li>按照被定义的位置划分<ul>
<li>成员变量：函数外部、类内部</li>
<li>局部变量：函数内部或语句块内部</li>
</ul>
</li>
<li>按照所属的数据类型划分<ul>
<li>基本数据类型变量<strong>（栈）</strong></li>
<li>引用数据类型变量<strong>（堆）</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="3-类的定义"><a href="#3-类的定义" class="headerlink" title="3. 类的定义"></a>3. 类的定义</h3><ul>
<li><p><strong>一个基本 Java 程序的组成</strong></p>
<ul>
<li>包的声明：指定类所在的位置</li>
<li>类的导入：用到其他位置的类</li>
<li>类的定义：核心部分</li>
</ul>
<blockquote>
<p><strong>Java 允许在一个源文件中编写多个类，但至多只能有一个使用<code>public</code>修饰。</strong></p>
</blockquote>
</li>
<li><p><strong>类的定义格式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[类修饰符] <span class="keyword">class</span> <span class="title class_">Name</span> [extends 父类] [implements 接口列表] &#123;</span><br><span class="line">	[成员变量]</span><br><span class="line">	[成员函数]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>类修饰符分为访问控制符和类型说明符</p>
<ul>
<li><p>类的访问控制符有两个，一个是<code>public</code>，另一个是默认（没有）</p>
<blockquote>
<p>公共类表示能被其他所有类访问和引用。</p>
<p>一个源文件只能有一个公共类，其中一般含有 main 函数。</p>
<p>默认访问属性的类，只能被同一个包中定义的类访问和引用。</p>
</blockquote>
</li>
<li><p>类的类型说明符主要有<code>final</code>和<code>abstract</code>。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>成员变量的定义格式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[修饰符] Type name [= initValue];</span><br></pre></td></tr></table></figure>

<ul>
<li>修饰符主要有<code>static</code> <code>public</code> <code>private</code> <code>protected</code> <code>final</code> <code>默认</code></li>
</ul>
</li>
<li><p><strong>成员函数的定义格式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[修饰符] Type <span class="title function_">name</span><span class="params">([形参列表])</span> [<span class="keyword">throws</span> 异常列表] &#123;</span><br><span class="line">	[局部变量定义]</span><br><span class="line">	[语句]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>修饰符主要有<code>static</code> <code>public</code> <code>private</code> <code>protected</code> <code>final</code> <code>默认</code></li>
</ul>
</li>
<li><p><strong><code>this</code>关键字</strong></p>
<ul>
<li>Java 每个类都默认具有<code>null</code> <code>this</code> <code>super</code>三个域。<code>null</code>表示空，用在定义一个对象但尚未为之开辟内存空间时；<code>this</code>和<code>super</code>是指代本类对象和父类对象的关键字。</li>
<li><code>this</code>是一个变量，其值是当前对象的引用。<strong>使用<code>this</code>可以解决函数中成员变量和局部变量重名的问题。</strong></li>
</ul>
</li>
<li><p><strong>参数传递</strong></p>
<ul>
<li>基本类型作为参数传递时，其实只是将值复制了一份传给函数的局部变量。<strong>（深拷贝）</strong></li>
<li>引用变量作为参数传递时，其实是将其所保存的<strong>堆上的内存地址（引用）</strong>复制了一份传给函数的局部变量。<strong>（浅拷贝）</strong></li>
</ul>
<blockquote>
<p>引用变量只保存对象在堆上的内存地址（引用）。<strong>引用变量是对象的管理者。</strong>引用变量的赋值是<strong>指向同一个对象（同一片内存空间）</strong>的过程。<strong>引用变量用<code>==</code>判断是否相等，实际是判断两个变量是否管理同一个对象。</strong></p>
</blockquote>
</li>
<li><p><strong>函数重载</strong></p>
<ul>
<li>函数重载指的是一个类中可以定义多个<strong>同名、但参数不同</strong>的函数。</li>
<li>重载的函数必须满足<ul>
<li>函数名相同</li>
<li>形参的类型、个数、顺序<strong>至少有一项不同</strong></li>
</ul>
</li>
<li><strong>重载的函数的返回类型可以不同。</strong></li>
<li><strong>重载的函数的修饰符可以不同。</strong></li>
<li>调用重载函数时，根据参数的类型和数量决定调用哪个版本。</li>
</ul>
</li>
</ul>
<h3 id="4-对象的生成和清除"><a href="#4-对象的生成和清除" class="headerlink" title="4. 对象的生成和清除"></a>4. 对象的生成和清除</h3><ul>
<li><p><strong>构造函数（constructor）</strong></p>
<ul>
<li><p>特点</p>
<ul>
<li>与类同名</li>
<li>无返回值</li>
<li>多数情况下需要重载</li>
</ul>
</li>
<li><p><code>new</code>的使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ClassName</span> <span class="variable">objectName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassName</span>(args);</span><br></pre></td></tr></table></figure>

<p><code>new</code>的作用是：(1)为对象分配堆上的内存空间；(2)引起对象对应构造函数的调用；(3)返回对象的引用。</p>
</li>
<li><p><strong>每个类至少有一个构造函数。</strong>如果没有定义构造函数，<strong>编译器会自动创建无参数、函数体为空的默认构造函数</strong>。如果定义了有参的构造函数，<strong>默认构造函数就不会被自动创建，必须手动重载</strong>。</p>
</li>
<li><p>调用默认构造函数时，成员变量的值被赋予了数据类型的隐含初值。</p>
</li>
</ul>
</li>
<li><p><strong>内存管理（垃圾自动回收机制）</strong></p>
<ul>
<li>Java 虚拟机后台线程负责内存的回收。</li>
<li>垃圾强制回收函数<code>System.gc()</code>和<code>Runtime.gc()</code>用来强制立即回收垃圾，但是系统并不会保证立即回收。</li>
<li>判断一个存储存储单元是否是垃圾的依据：该存储单元对应的对象是否仍被程序所用，也即<strong>是否有引用指向该对象</strong>。</li>
</ul>
</li>
<li><p><strong>匿名对象</strong></p>
<ul>
<li><code>Student stu = new Student();</code>创建了一个<code>Student</code>类型的名为<code>stu</code>的对象，<code>new Student();</code>则创建了一个<code>Student</code>类型的匿名对象。</li>
<li>匿名对象用完之后就变成垃圾被回收了，因为在其定义的时候并没有栈内存的引用变量指向它。</li>
<li>使用场景<ul>
<li>一个对象只需要进行一次函数调用</li>
<li>作为实参传递给一个函数</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="5-static"><a href="#5-static" class="headerlink" title="5. static"></a>5. <code>static</code></h3><ul>
<li><p><strong>静态成员变量（类变量）和静态成员函数（类函数）</strong></p>
<ul>
<li>静态成员在<strong>类加载</strong>的时候就已经被装载和分配，它们不依赖于对象而存在。</li>
<li>即使没有创建该类的对象，<code>static</code>的成员变量也会存在，故可以通过<code>类名.静态成员变量名</code>或<code>对象名.静态成员变量名</code>访问。</li>
<li>即使没有创建该类的对象，<code>static</code>的成员函数也可以调用，故可以通过<code>类名.静态成员函数名</code>或<code>对象名.静态成员函数名</code>调用。</li>
<li><strong>静态成员函数只能访问静态成员，而不能访问非静态成员。</strong>非静态成员函数既可以访问静态成员也可以访问非静态成员。</li>
</ul>
</li>
<li><p><strong>静态代码块</strong></p>
<ul>
<li><p><strong>用${}$包裹起来的语句体称为代码块。</strong>其中静态代码块的格式为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">	<span class="comment">// statements</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>静态代码块<strong>只能定义在类中</strong>，它独立于任何函数，不能定义在函数里面。</p>
</li>
<li><p>静态代码块中声明的变量都是局部变量，只在本块内有效。<strong>静态代码块一般用于初始化类的静态成员变量。静态代码块不能访问类的非静态成员。</strong></p>
</li>
<li><p>一个类允许定义多个静态代码块，<strong>按照定义的顺序执行</strong>。</p>
</li>
<li><p><code>new</code>一个对象的语句执行顺序</p>
<blockquote>
<p><strong>第一次<code>new</code>该类对象时</strong></p>
<ul>
<li>初始化有显式初始化的<code>static</code>成员变量</li>
<li>按顺序执行<code>static</code>语句块</li>
<li>初始化有显式初始化的非<code>static</code>成员变量</li>
<li>按顺序执行非<code>static</code>语句块</li>
<li>调用构造函数</li>
</ul>
<p><strong>之后再<code>new</code>该类对象时</strong></p>
<ul>
<li>初始化有显式初始化的非<code>static</code>成员变量</li>
<li>按照顺序执行非<code>static</code>语句块</li>
<li>调用构造函数</li>
</ul>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="6-访问控制修饰符"><a href="#6-访问控制修饰符" class="headerlink" title="6. 访问控制修饰符"></a>6. 访问控制修饰符</h3><ul>
<li><p><strong>访问控制的四种级别</strong></p>
<ul>
<li>公开级别：用<code>public</code>修饰，对外公开。</li>
<li>受保护级别：用<code>protected</code>修饰，向子类及同一个包中的类公开。</li>
<li>默认级别：<code>default</code>&#x2F;没有访问控制修饰符，向同一个包中的类公开。</li>
<li>私有级别：用<code>private</code>修饰，只有类本身可以访问，不对外公开。</li>
</ul>
<table>
<thead>
<tr>
<th align="center">修饰符</th>
<th align="center">同一个类</th>
<th align="center">同一个包</th>
<th align="center">子类</th>
<th align="center">整体</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>private</code></td>
<td align="center"><strong>可见</strong></td>
<td align="center">不可见</td>
<td align="center">不可见</td>
<td align="center">不可见</td>
</tr>
<tr>
<td align="center"><code>default</code>&#x2F;没有</td>
<td align="center"><strong>可见</strong></td>
<td align="center"><strong>可见</strong></td>
<td align="center">不可见</td>
<td align="center">不可见</td>
</tr>
<tr>
<td align="center"><code>protected</code></td>
<td align="center"><strong>可见</strong></td>
<td align="center"><strong>可见</strong></td>
<td align="center"><strong>可见</strong></td>
<td align="center">不可见</td>
</tr>
<tr>
<td align="center"><code>public</code></td>
<td align="center"><strong>可见</strong></td>
<td align="center"><strong>可见</strong></td>
<td align="center"><strong>可见</strong></td>
<td align="center"><strong>可见</strong></td>
</tr>
</tbody></table>
</li>
<li><p><strong><code>protected</code>详解</strong></p>
<ul>
<li><p><strong><code>protected</code>成员包内可见。</strong></p>
</li>
<li><p><strong><code>protected</code>成员对子类可见。</strong></p>
<ul>
<li>如果子类和父类在同一个包中，自然可见父类所有<code>protected</code>成员。子类可以直接访问该成员，也可以通过自己的对象访问该成员，还可以通过父类对象访问该成员。</li>
<li>如果子类和父类不在一个包中，仍可见父类所有<code>protected</code>成员。子类可以直接访问该成员，也可通过自己的对象访问该成员，但是不能通过父类对象访问。</li>
<li>同一个父类的不同子类间，相互之间不能通过对方的对象访问从父类那里得到的<code>protected</code>成员。</li>
</ul>
</li>
<li><p><strong><code>protected</code>的<code>static</code>成员对所有子类可见。</strong></p>
<p>子类可以通过直接访问、自身对象访问、父类对象访问、同父类的其他子类对象访问其父类的static成员。</p>
</li>
</ul>
</li>
<li><p><strong>单例模式</strong></p>
<ul>
<li><p><strong>对于单例模式的类，它在内存中只有一个实例存在。</strong>对于(1)需要使用一个单独的共享的资源；(2)需要频繁创建和销毁的对象；(3)创建时开销过大但又需要经常用到的对象；(4)工具类对象；(5)频繁访问的数据库或文件对象等，应考虑单例模式。</p>
</li>
<li><p>“饿汉式”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">/**********************************************************</span></span><br><span class="line"><span class="comment">    ** 多线程安全，没有加锁，执行效率会提高；但在最开始就初始化，浪费内存</span></span><br><span class="line"><span class="comment">    ***********************************************************/</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Singleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();	<span class="comment">// 类加载时创建</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="title function_">Singleton</span><span class="params">()</span> getInstance() &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>“懒汉式”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">/**********************</span></span><br><span class="line"><span class="comment">    ** 多线程不安全，除非加锁</span></span><br><span class="line"><span class="comment">    ***********************/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Singleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();	<span class="comment">// 第一次使用时创建</span></span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">realGetInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="literal">null</span>) instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="四、继承"><a href="#四、继承" class="headerlink" title="四、继承"></a>四、继承</h2><h3 id="1-Java-的继承"><a href="#1-Java-的继承" class="headerlink" title="1. Java 的继承"></a>1. Java 的继承</h3><ul>
<li><p><strong>Java 不支持类的多继承，但支持接口的多继承。</strong></p>
</li>
<li><p>Java 继承的实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[修饰符] <span class="keyword">class</span> <span class="title class_">SubClass</span> <span class="keyword">extends</span> <span class="title class_">SuperClass</span> &#123;</span><br><span class="line">	<span class="comment">// body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-子类的构造函数"><a href="#2-子类的构造函数" class="headerlink" title="2. 子类的构造函数"></a>2. 子类的构造函数</h3><ul>
<li><strong>父类的构造函数不能被子类继承。</strong></li>
<li>子类可以通过<code>super();</code>显式调用父类的默认构造，也可以隐式调用；如果要调用父类的有参构造，必须明确地写<code>super(args);</code>。不论何种情况，必须在子类构造函数的第一句调用父类的构造。</li>
<li><strong><code>new</code>出子类对象时，总会按照层次结构从上到下调用所有父类的构造。</strong></li>
<li><strong>总结</strong><ul>
<li><code>super</code>用于<ul>
<li>引用父类的成员变量<code>super.age = 10;</code></li>
<li>调用父类的成员函数<code>super.show();</code></li>
<li>调用父类的构造函数<code>super(&quot;Jack&quot;, 24);</code></li>
</ul>
</li>
<li><code>this</code>用于<ul>
<li>引用自身的成员变量<code>this.age = 10;</code></li>
<li>调用自身的成员函数<code>this.show();</code></li>
<li>调用自身的构造函数<code>this(&quot;Tom&quot;, 26, Jobs.MANAGER);</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="3-继承中的变量隐藏"><a href="#3-继承中的变量隐藏" class="headerlink" title="3. 继承中的变量隐藏"></a>3. 继承中的变量隐藏</h3><ul>
<li>如果子类新增的成员变量和父类原有的成员变量<strong>同名</strong>，则子类隐藏了父类的成员变量。</li>
<li><strong>在子类中访问其隐藏的父类成员变量，应写<code>super.变量名</code>。</strong></li>
</ul>
<h3 id="4-函数的重写（Override）"><a href="#4-函数的重写（Override）" class="headerlink" title="4. 函数的重写（Override）"></a>4. 函数的重写（Override）</h3><ul>
<li><strong>重写&#x2F;覆盖就是子类重新书写了父类的某个函数。</strong>构成覆盖的条件是<ul>
<li>子类的返回值类型必须与父类的<strong>相同或是其子类</strong></li>
<li>子类和父类的<strong>函数名和参数列表完全相同</strong></li>
<li><strong>访问权限不能更低</strong>，只能相同或更高</li>
<li><strong>子类中抛出异常的范围不能更大</strong></li>
</ul>
</li>
<li><strong>重写时的注意事项</strong><ul>
<li><strong>私有函数</strong>不能继承，故不能覆盖</li>
<li><strong>构造函数</strong>不能继承，故不能覆盖</li>
<li><strong>静态函数</strong>不存在覆盖</li>
<li>用<code>final</code>声明的成员函数是<strong>最终函数</strong>，不能被子类重写</li>
</ul>
</li>
</ul>
<h2 id="五、多态（Polymorphism）"><a href="#五、多态（Polymorphism）" class="headerlink" title="五、多态（Polymorphism）"></a>五、多态（Polymorphism）</h2><h3 id="1-多态性"><a href="#1-多态性" class="headerlink" title="1. 多态性"></a>1. 多态性</h3><ul>
<li>Java 的引用类型分为两种——<strong>编译时类型</strong>和<strong>运行时类型</strong>。前者由<strong>定义该变量的类型</strong>决定，后者由实际赋给给变量的<strong>对象的类型</strong>决定。</li>
<li>多态性指的是<strong>“拥有多种形态”</strong>，具体指用相同的名称来表示不同的含义。</li>
<li>多态可以分为<strong>静多态</strong>和<strong>动多态</strong>。</li>
</ul>
<h3 id="2-静多态"><a href="#2-静多态" class="headerlink" title="2. 静多态"></a>2. 静多态</h3><ul>
<li><p><strong>静多态</strong>即在编译时决定调用哪个函数，也称为<strong>编译时多态</strong>、<strong>静态联编</strong>、<strong>静绑定</strong>。</p>
</li>
<li><p>静多态一般指<strong>函数重载和隐藏</strong>。</p>
</li>
<li><p><strong>静多态与是否发生继承没有必然联系。</strong></p>
<blockquote>
<p><strong>注意</strong></p>
<ul>
<li>函数重载时的<strong>返回值类型和访问权限修饰符可以相同也可以不同</strong>，不能以此为是否重载的判断条件。</li>
<li>如果一个类中有两个同名、参数列表完全相同的函数，仅返回值类型不同，编译时会出错。（因为编译器不知道这两个函数未来会怎样被调用，例如，一个有返回值的函数其返回值也可以不被使用）</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="3-动多态"><a href="#3-动多态" class="headerlink" title="3. 动多态"></a>3. 动多态</h3><ul>
<li><p>函数的覆盖指的是子类的成员函数重写了父类的成员函数，重写的目的很大程度是为了实现多态。</p>
</li>
<li><p><strong>动多态</strong>即在运行时才能确定调用哪个函数，也称为<strong>运行时多态</strong>、<strong>动态联编</strong>、<strong>动绑定</strong>。</p>
</li>
<li><p><strong>实现动多态必须具备三个条件</strong></p>
<ul>
<li><strong>继承</strong>：必须要存在继承的情况</li>
<li><strong>覆盖</strong>：子类必须重写父类的函数</li>
<li><strong>向上造型（Upcasting）</strong>：必须用父类的引用管理子类的对象，并通过此引用调用那个被重写的函数</li>
</ul>
<blockquote>
<p><strong>注意</strong></p>
<ul>
<li><p>子类的成员变量和父类同名，会出现<strong>变量隐藏</strong>的情况；子类“重写”父类的<code>private</code>或<code>static</code>函数，会出现<strong>函数隐藏</strong>的情况。<strong>用父类引用访问那个被隐藏的变量，只会访问父类的那个变量；用父类引用调用那个被隐藏的函数，只会调用父类的那个函数。</strong></p>
</li>
<li><p>向上造型可以通过父类的引用动态调用子类重写的函数，<strong>但不能访问子类新增的成员</strong>。此时可以通过<strong>强制转型（向下造型）</strong>访问子类新增的成员，<strong>但有风险存在</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SuperClass</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;SuperClass::f()&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SubClass</span> <span class="keyword">extends</span> <span class="title class_">SuperClass</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;SubClass::f()&quot;</span>); &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">g</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;SubClass::g()&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SuperClass</span> <span class="variable">superClass</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubClass</span>();</span><br><span class="line">        superClass.f();		<span class="comment">// 正确，输出 SubClass::f()</span></span><br><span class="line">        superClass.g();		<span class="comment">// 错误</span></span><br><span class="line">        <span class="type">SubClass</span> <span class="variable">subClass</span> <span class="operator">=</span> (SubClass)superClass;</span><br><span class="line">        subClass.g();		<span class="comment">// 正确，但有风险，输出 SubClass::g()</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="4-抽象（Abstract）"><a href="#4-抽象（Abstract）" class="headerlink" title="4. 抽象（Abstract）"></a>4. 抽象（Abstract）</h3><ul>
<li><p>关键字<code>abstract</code>可用来修饰类和函数，表示<strong>“尚未实现”</strong>的含义。</p>
</li>
<li><p><strong>抽象类</strong></p>
<ul>
<li><p>抽象类的声明</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">ClassName</span> &#123;</span><br><span class="line">	<span class="comment">// body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>一个普通的类也可以用<code>abstract</code>修饰，只是没有含义。但是，<strong>含有抽象函数的类，必须用<code>abstract</code>修饰。</strong></p>
</li>
</ul>
</li>
<li><p><strong>抽象函数</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">funcName</span><span class="params">()</span>;	</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>抽象函数没有函数体。</strong></li>
<li><strong>抽象函数必须在抽象类里。</strong></li>
<li><strong>抽象函数必须在子类中被实现，除非子类是抽象类。</strong></li>
</ul>
<blockquote>
<p><strong>注意</strong></p>
<p>无函数体和函数体为空是两个不同的概念。</p>
</blockquote>
</li>
<li><p><strong>更多的细节</strong></p>
<ul>
<li>抽象类一般用在<strong>父类对象没有机会被访问调用、父类的函数无法明确实现</strong>的情况下。例如飞机和民航客机、民用运输机、战斗机等的关系——飞机具有一些公共属性，但<strong>飞机只是一个抽象的概念</strong>，其实现必须依赖更具体的子类。对于飞机制造者，让他“造一架飞机”，他也不清楚要造什么样的飞机；对于看到某种飞机的普通人，他会说“这是一架飞机”。这体现了抽象和具体并存的重要性。</li>
<li><strong>不能实例化抽象类。</strong>但是，可以通过抽象类的引用管理其子类，实现动态联编。</li>
<li><strong>含有抽象函数的类必须是抽象类。</strong><ul>
<li>如果一个类继承自某个抽象父类，而<strong>没有实现或只是部分实现了父类的抽象函数</strong>，则这个子类也得声明为抽象类。</li>
<li>当一个类声明实现了某个接口，但并<strong>没有实现或只是部分实现了该接口的函数</strong>，则这个类必须声明为抽象类。</li>
<li>从抽象到具体是一个逐步实现的过程，<strong>一个抽象类中也可以书写成员变量和函数</strong>，包括静态的类变量和类函数。</li>
</ul>
</li>
<li>抽象函数不能被<code>private</code>、<code>final</code>和<code>static</code>修饰。因为这类函数均无法被重写，即<strong>不能被子类实现</strong>。</li>
</ul>
</li>
</ul>
<h2 id="六、接口（Interface）"><a href="#六、接口（Interface）" class="headerlink" title="六、接口（Interface）"></a>六、接口（Interface）</h2><h3 id="1-接口的概念"><a href="#1-接口的概念" class="headerlink" title="1. 接口的概念"></a>1. 接口的概念</h3><ul>
<li><strong>概念性的接口</strong>，指的是一个类的所有<strong>能被外界访问的函数</strong>。</li>
<li>用<code>interface</code>关键字定义的<strong>接口类型</strong>。Java 接口是一系列函数特征的集合，但不具有函数的实现。这些函数将在不同的地方被不同的类实现，于是这些类将具有不同的功能。<strong>接口是类的行为的规范。</strong></li>
</ul>
<h3 id="2-接口的实现"><a href="#2-接口的实现" class="headerlink" title="2. 接口的实现"></a>2. 接口的实现</h3><ul>
<li><p>接口是一种<strong>特殊的抽象类</strong>，是一种<strong>复合数据类型</strong>，定义一个接口的格式为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">public</span>] <span class="keyword">interface</span> <span class="title class_">InterfaceName</span> [extends 父接口] &#123;</span><br><span class="line">    [常量]</span><br><span class="line">    [函数]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>接口中所有函数都默认、也必须是<code>public abstract</code>的，并且没有函数体，以分号结尾。</strong></p>
</li>
<li><p><strong>接口中所有变量都默认、也必须是<code>public static final</code>的。</strong></p>
</li>
<li><p><strong>接口没有构造函数。</strong></p>
</li>
<li><p>接口中的函数可以用 Java 书写，也可以用其他语言书写。对于后者，函数需要用<code>native</code>修饰。</p>
<blockquote>
<p><strong>注意</strong></p>
<ul>
<li>一个类在实现接口的函数时，应采用完全相同的函数头，否则只是重载。</li>
<li>接口的抽象函数访问权限是<code>public</code>，类在实现时，必须显式使用<code>public</code>修饰符。</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="3-接口回调"><a href="#3-接口回调" class="headerlink" title="3. 接口回调"></a>3. 接口回调</h3><blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// InterfaceEg.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">InterfaceEg</span> &#123;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyClass.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> <span class="keyword">implements</span> <span class="title class_">InterfaceEg</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="comment">// do something</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="type">InterfaceEg</span> <span class="variable">interfaceEg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">		interfaceEg.f();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li><strong>用一个接口类型的引用去管理实现了该接口的类的对象，则可以通过这个引用去调用接口中的那些函数。</strong></li>
<li>接口也可以作为<strong>函数形参</strong>，但实际传入的参数是实现了该接口的类的对象的引用，从而在函数中实现接口回调。</li>
</ul>
<h3 id="4-接口的继承"><a href="#4-接口的继承" class="headerlink" title="4. 接口的继承"></a>4. 接口的继承</h3><ul>
<li><p>接口可以像普通类那样用<code>extends</code>继承父接口，从而得到父接口中的所有成员。</p>
</li>
<li><p>接口中的函数在某一个实现该接口的类中，只能被书写一次。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// In1.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">In1</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// In2.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">In2</span> <span class="keyword">extends</span> <span class="title class_">In1</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AnotherIn.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AnotherIn</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyClass.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> <span class="keyword">implements</span> <span class="title class_">In1</span>, In2, AnotherIn &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;hello&quot;</span>); &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">        test.f();			<span class="comment">// OK，输出 hello</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">In1</span> <span class="variable">in1</span> <span class="operator">=</span> test;</span><br><span class="line">        in1.f();			<span class="comment">// OK，输出 hello</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">In2</span> <span class="variable">in2</span> <span class="operator">=</span> test;</span><br><span class="line">        in2.f();			<span class="comment">// OK，输出 hello</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">AnotherIn</span> <span class="variable">in</span> <span class="operator">=</span> test;</span><br><span class="line">        in.f();				<span class="comment">// OK，输出 hello</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>不同接口（包括父子接口）中同名的变量<strong>相互隐藏</strong>，使用时应用<code>接口名.变量名</code>的形式明确指出。</p>
<ul>
<li><p><strong>Case 1</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// In.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">In</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyClass.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> <span class="keyword">implements</span> <span class="title class_">In</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">22</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">33</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(a);			<span class="comment">// OK，但不推荐，输出 1</span></span><br><span class="line">        System.out.println(In.a);		<span class="comment">// 正确的</span></span><br><span class="line">        System.out.println(b);			<span class="comment">// 输出 22</span></span><br><span class="line">        System.out.println(In.b);		<span class="comment">// 输出 2</span></span><br><span class="line">        System.out.println(c);			<span class="comment">// 输出 33</span></span><br><span class="line">        System.out.println(In.c);		<span class="comment">// 输出 3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Case 2</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// In1.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">In1</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">11</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// In2.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">In2</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">22</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyClass.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> <span class="keyword">implements</span> <span class="title class_">In1</span>, In2 &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">999</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(a);			<span class="comment">// 错误，存在冲突</span></span><br><span class="line">        System.out.println(In1.a);		<span class="comment">// OK，输出 1</span></span><br><span class="line">        System.out.println(In2.a);		<span class="comment">// OK，输出 2</span></span><br><span class="line">        </span><br><span class="line">        System.out.println(b);			<span class="comment">// OK，输出 999</span></span><br><span class="line">        System.out.println(In1.b);		<span class="comment">// OK，输出 11</span></span><br><span class="line">        System.out.println(In2.b);		<span class="comment">// OK，输出 22</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="5-instanceof"><a href="#5-instanceof" class="headerlink" title="5. instanceof"></a>5. <code>instanceof</code></h3><ul>
<li><p><strong>向上造型总是安全的。</strong>这一手段可以实现<strong>动多态</strong>，<strong>代价是无法通过父类的引用访问子类新增的成员</strong>。</p>
</li>
<li><p><strong>向下造型是有风险的。</strong>如果不可以转型，会发生<strong>运行时错误</strong>，这是编译时刻无法确定的。</p>
</li>
<li><p><code>instanceof</code>是一个<strong>二元运算符</strong>，用于判断一个引用类型所管理的对象是不是一个类的实例。其左侧的算子是一个<strong>引用类型变量</strong>（可以是<code>null</code>），右侧算子是一个<strong>类名或接口名</strong>。此运算符的结果是<code>boolean</code>类型的<code>true</code>或<code>false</code>。</p>
</li>
<li><p><strong><code>instanceof</code>的细节</strong></p>
<ul>
<li><p>表达式<code>A instanceof B</code>的值为<code>true</code>的情况包括</p>
<ul>
<li>引用<code>A</code>管理类<code>B</code>的对象</li>
<li><code>B</code>为<code>A</code>的直接或间接父类</li>
<li><code>B</code>为<code>A</code>实现的接口</li>
</ul>
</li>
<li><p>强制转型，有可能发生<strong>编译错误</strong>，也有可能**抛出<code>ClassCastException</code>**。</p>
<ul>
<li><p><strong>编译错误的可能情形</strong></p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 毫不相关的类之间强制转型</span></span><br><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> (String)random;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用接口管理未实现该接口的 final 类</span></span><br><span class="line"><span class="type">Integer</span> <span class="variable">integer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">10</span>);</span><br><span class="line"><span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> (List)integer;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用一个 final 类管理其未实现的接口</span></span><br><span class="line"><span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;();</span><br><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> (String)list; </span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p><strong>抛出异常的可能情形</strong></p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用子类管理父类(哪怕子类是 final 的)</span></span><br><span class="line">Vector&lt;Integer&gt; vector = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;Integer&gt;();</span><br><span class="line">Stack&lt;Integer&gt; stack = (Stack&lt;Integer&gt;)vector;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用接口管理未实现该接口的普通类</span></span><br><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"><span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> (List)random;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用未实现某个接口的普通类管理该接口</span></span><br><span class="line"><span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> (Random)list;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用一个接口管理另一个接口</span></span><br><span class="line"><span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line"><span class="type">Runnable</span> <span class="variable">runnable</span> <span class="operator">=</span> (Runnable)list;</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
</li>
<li><p>当强制转型不能通过编译时，<code>instanceof</code>也不能通过编译；当强制转型会抛出异常时，<code>instanceof</code>返回<code>false</code>。</p>
</li>
</ul>
</li>
</ul>
<h2 id="七、类的进阶设计"><a href="#七、类的进阶设计" class="headerlink" title="七、类的进阶设计"></a>七、类的进阶设计</h2><h3 id="一-OOP-的若干基本原则"><a href="#一-OOP-的若干基本原则" class="headerlink" title="(一) OOP 的若干基本原则"></a>(一) OOP 的若干基本原则</h3><h4 id="1-UML-图"><a href="#1-UML-图" class="headerlink" title="1.  UML 图"></a>1.  UML 图</h4><ul>
<li><p><strong>统一建模语言（UML，Unified Modeling Language），又称标准建模语言，是用来对软件密集系统进行可视化建模的一种语言。</strong></p>
<p><img src="https://github.com/Pan-Pan-Pan/AssetsForBlog/tree/main/OOP/2.png"><img src="/2023/01/07/OOP/2.PNG" alt="截屏2022-12-11 23.41.43" style="zoom: 33%;">]</p>
</li>
</ul>
<h4 id="2-面向抽象原则：面向接口的编程"><a href="#2-面向抽象原则：面向接口的编程" class="headerlink" title="2. 面向抽象原则：面向接口的编程"></a>2. 面向抽象原则：面向接口的编程</h4><ul>
<li><p><strong>含义</strong></p>
<blockquote>
<p><strong>所有具有相同功能的组件都应该实现某个接口，或从某个抽象类继承。</strong></p>
<p><strong>客户代码只应该和接口通讯。</strong></p>
<ul>
<li>降低代码耦合性，提升代码可维护性</li>
<li>修改一方不会影响另一方</li>
<li>提升代码复用性</li>
</ul>
</blockquote>
</li>
<li><p>设计一个类时，应<strong>面向抽象类或接口</strong>，即类中的重要数据应该是抽象类或接口定义的变量，而不是该类本身定义的变量；类中的重要函数应该是抽象类或接口声明的函数，而不是该类本身定义的函数。</p>
<blockquote>
<p><strong>Example</strong></p>
<ul>
<li><p>传统做法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Circle.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Circle</span> &#123;</span><br><span class="line">    <span class="type">double</span> r;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Circle</span><span class="params">(<span class="type">double</span> r)</span> &#123; <span class="keyword">if</span> (r &gt; <span class="number">0</span>) <span class="built_in">this</span>.r = r &gt; <span class="number">0</span> ? r : <span class="number">0.0</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getArea</span><span class="params">()</span> &#123; <span class="keyword">return</span> Math.PI * r * r; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Pillar.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pillar</span> &#123;</span><br><span class="line">    Circle bottom;</span><br><span class="line">    <span class="type">double</span> height;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Pillar</span><span class="params">(Circle circ, <span class="type">double</span> h)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bottom = circ; </span><br><span class="line">        <span class="built_in">this</span>.height = h &gt; <span class="number">0</span> ? h : <span class="number">0.0</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getVolume</span><span class="params">()</span> &#123; <span class="keyword">return</span> bottom.getArea * height; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>面向接口的做法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AreaGettable.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AreaGettable</span> &#123;</span><br><span class="line">    <span class="type">double</span> <span class="title function_">getArea</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Circle.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Circle</span> <span class="keyword">implements</span> <span class="title class_">AreaGettable</span> &#123;</span><br><span class="line">    <span class="type">double</span> r;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Circle</span><span class="params">(<span class="type">double</span> r)</span> &#123; <span class="keyword">if</span> (r &gt; <span class="number">0</span>) <span class="built_in">this</span>.r = r &gt; <span class="number">0</span> ? r : <span class="number">0.0</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getArea</span><span class="params">()</span> &#123; <span class="keyword">return</span> Math.PI * r * r; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Pillar.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pillar</span> &#123;</span><br><span class="line">    AreaGettable bottom;</span><br><span class="line">    <span class="type">double</span> height;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Pillar</span><span class="params">(AreaGettable bottom, <span class="type">double</span> h)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bottom = bottom; </span><br><span class="line">        <span class="built_in">this</span>.height = h &gt; <span class="number">0</span> ? h : <span class="number">0.0</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getVolume</span><span class="params">()</span> &#123; <span class="keyword">return</span> bottom.getArea * height; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
</li>
</ul>
<h4 id="3-优先使用组合少用继承原则"><a href="#3-优先使用组合少用继承原则" class="headerlink" title="3. 优先使用组合少用继承原则"></a>3. 优先使用组合少用继承原则</h4><ul>
<li><strong>函数复用的两种常用技术：类继承和对象组合。</strong></li>
<li><strong>继承的缺点</strong><ul>
<li><strong>继承破坏了封装。</strong>通过继承复用也称“白盒”复用，父类的细节对子类是可见的。</li>
<li>子类和父类是<strong>强耦合关系</strong>，父类的改变必然引起子类的改变。</li>
<li>子类从父类继承来的函数在编译时就确定了，<strong>无法在运行期间改变从父类继承的函数的行为</strong>。</li>
</ul>
</li>
<li><strong>对象组合的优点</strong><ul>
<li>新的更复杂的功能可以通过<strong>组合对象</strong>来获得。</li>
<li>对象组合要求对象定义<strong>良好的接口</strong>，这种复用方式也被称为“黑箱”复用，即被组合的对象的内部细节是不可见的。</li>
<li>对象与其所包含的对象是<strong>弱耦合关系</strong>，修改一个类所包含的类的代码，不必修改此类本身的代码。</li>
<li><strong>当前对象可以在运行时刻动态指定。</strong></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Animal.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    String <span class="title function_">getMessage</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal1</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;I&#x27;m tiger.&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal3</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;I&#x27;m panda.&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal4</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;I&#x27;m lion.&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal8</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;I&#x27;m giraffe.&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Zoo.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Zoo</span> &#123;</span><br><span class="line">    <span class="type">Animal</span> <span class="variable">animal</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAnimal</span><span class="params">(Animal animal)</span> &#123; <span class="built_in">this</span>.animal = animal; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (animal == <span class="literal">null</span>) System.out.println(<span class="string">&quot;No animal in the zoo.&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> System.out.println(<span class="string">&quot;The current animal says: &quot;</span> + animal.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Zoo</span> <span class="variable">zoo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Zoo</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                zoo.show();</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                Class&lt;?&gt; cs = Class.forName(<span class="string">&quot;Animal&quot;</span> + i);</span><br><span class="line">                <span class="type">Animal</span> <span class="variable">a</span> <span class="operator">=</span> (Animal)cs.getDeclaredConstructor().newInstance();</span><br><span class="line">                	<span class="comment">// 换动物，出错抛异常</span></span><br><span class="line">                zoo.setAnimal(a);</span><br><span class="line">                idx++;</span><br><span class="line">            &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">                idx++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (idx &gt; <span class="number">10</span>) idx = <span class="number">1</span>;		<span class="comment">// 最多十种动物</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	运行 main 后，可继续编写其他 Animal 的子类。编译后，程序输出将发生变化。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h4 id="4-更多的原则"><a href="#4-更多的原则" class="headerlink" title="4. 更多的原则"></a>4. 更多的原则</h4><ul>
<li><p><strong>开-闭原则</strong></p>
<ul>
<li><p>设计应当<strong>对扩展开放、对修改关闭</strong>，即在增加一个新的模块时，不需要修改现有的模块。</p>
<blockquote>
<p>上例中计算柱体体积的程序，由于<code>AreaGettable</code>接口的存在，系统中对于新的柱体底面的添加是开放的，对体积计算是关闭的。</p>
</blockquote>
</li>
</ul>
</li>
<li><p><strong>高内聚-低耦合原则</strong></p>
<ul>
<li><p><strong>高内聚：内聚描述一个模块自身的特性。</strong>模块内部的元素关联性越强，则内聚程度越高、模块单一性越强。</p>
<blockquote>
<p>例如，系统存在 A 和 B 两个模块进行交互，如果修改 A 不影响 B 的工作，比如 B 只调用了 A 的 getter 和 setter 等，那么可以认为 A 模块具有足够的内聚。</p>
</blockquote>
</li>
<li><p><strong>低耦合：耦合描述模块之间的依赖程度。</strong>模块之间的依赖程度越低，则一个模块的改动对其他模块的影响程度越小。</p>
<blockquote>
<p>例如，如果模块 A 直接修改了模块 B 的数据，则视为高耦合；如果 A 只是通过发消息与 B 交互，则视为低耦合。</p>
</blockquote>
</li>
</ul>
</li>
<li><p><strong>软件设计七大原则</strong></p>
<table>
<thead>
<tr>
<th align="center">原则</th>
<th>内容</th>
<th>目的</th>
</tr>
</thead>
<tbody><tr>
<td align="center">开-闭原则</td>
<td>对扩展开放，对修改关闭</td>
<td>降低维护带来的新风险</td>
</tr>
<tr>
<td align="center">依赖倒置原则</td>
<td>抽象不依赖具体，面向接口编程</td>
<td>便于代码结构层次的升级和拓展</td>
</tr>
<tr>
<td align="center">单一职责原则</td>
<td>一个类只干一件事</td>
<td>便于组织和理解，提升代码可读性</td>
</tr>
<tr>
<td align="center">接口隔离原则</td>
<td>一个接口只规定一件事</td>
<td>实现高内聚、低耦合</td>
</tr>
<tr>
<td align="center">迪米特法则</td>
<td>一个类应保持对其他类最少的了解</td>
<td>降低耦合，避免代码臃肿</td>
</tr>
<tr>
<td align="center">里氏替换原则</td>
<td>减少子类对父类的重写</td>
<td>减少程序出错，防止继承泛滥</td>
</tr>
<tr>
<td align="center">合成复用原则</td>
<td>多用组合，少用继承</td>
<td>降低代码耦合</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>关于里氏替换原则的例子</strong></p>
<p>计算不同鸟类飞行一段距离所需时间，特别，几维鸟（Kiwi）没有翅膀，所以不会飞。</p>
<ul>
<li><p>错误案例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bird.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> String type;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">double</span> speed;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">setType</span><span class="params">(String type)</span> &#123; <span class="built_in">this</span>.type = type; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSpeed</span><span class="params">(<span class="type">double</span> speed)</span> &#123; <span class="built_in">this</span>.speed = speed; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getFlyingTime</span><span class="params">(<span class="type">double</span> distance)</span> &#123; <span class="keyword">return</span> distance / speed; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Swallow</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Swallow</span><span class="params">()</span> &#123; setType(<span class="string">&quot;Swallow&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Kiwi</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Kiwi</span><span class="params">()</span> &#123; setType(<span class="string">&quot;Kiwi&quot;</span>); &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSpeed</span><span class="params">(<span class="type">double</span> speed)</span> &#123; <span class="built_in">this</span>.speed = <span class="number">0</span>; &#125;	</span><br><span class="line">    	<span class="comment">// 重写以保证几维鸟飞行速度为 0</span></span><br><span class="line">    	<span class="comment">// 对于几维鸟，调用 getFlyingTime 将出现除零错误</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>正确案例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Flyable.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Flyable</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setSpeed</span><span class="params">(<span class="type">double</span> speed)</span>;</span><br><span class="line">    <span class="type">double</span> <span class="title function_">getFlyingTime</span><span class="params">(<span class="type">double</span> distance)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Animal.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> String type;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">setType</span><span class="params">(String type)</span> &#123; <span class="built_in">this</span>.type = type; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bird.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bird</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> <span class="keyword">implements</span> <span class="title class_">Flyable</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">double</span> speed;	   <span class="comment">// 子类只添加成员，而不修改父类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSpeed</span><span class="params">(<span class="type">double</span> speed)</span> &#123; <span class="built_in">this</span>.speed = speed; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getFlyingTime</span><span class="params">(<span class="type">double</span> distance)</span> &#123; <span class="keyword">return</span> distance / speed; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Swallow</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Swallow</span><span class="params">()</span> &#123; setType(<span class="string">&quot;Swallow&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Kiwi.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Kiwi</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;		<span class="comment">// 更合理的关系</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Kiwi</span><span class="params">()</span> &#123; setType(<span class="string">&quot;Kiwi&quot;</span>); &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;I can&#x27;t fly.&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="二-几个重要的设计模式"><a href="#二-几个重要的设计模式" class="headerlink" title="(二) 几个重要的设计模式"></a>(二) 几个重要的设计模式</h3><blockquote>
<p><strong>设计模式（pattern）是针对某一类问题的最佳解决方案</strong>，程序设计过程中，应<strong>基于业务来选择设计模式</strong>。技术永远为业务服务，技术只是满足业务需要的一个工具。</p>
<p><strong>设计模式的具体分类</strong></p>
<ul>
<li><p><strong>创建型模式：涉及对象的实例化问题，避免用户直接使用<code>new</code>创建对象。</strong></p>
<ul>
<li><p><strong>单例模式 Singleton</strong></p>
<p>某个类只能生成一个实例，该类提供了一个全局访问点供外部获取该实例。可拓展为有限多例模式。</p>
</li>
<li><p><strong>原型模式 Prototype</strong></p>
<p>将一个对象作为原型，通过对其复制而克隆出多个和原型类似的对象。</p>
</li>
<li><p><strong>工厂模式 Factory</strong></p>
<p>定义一个用于创建产品的接口，由其实现类决定生产什么产品。</p>
</li>
<li><p><strong>抽象工厂模式 AbstractFactory</strong></p>
<p>提供一个用于创建产品族的接口，其每个实现类可以生产一系列相关产品。</p>
</li>
<li><p><strong>建造者模式 Builder</strong></p>
<p>将一个复杂对象分解成若干相对简单的部分，根据需要分别创建，最后组装。</p>
</li>
</ul>
</li>
<li><p><strong>结构型模式：涉及类和对象的结构组织问题。</strong></p>
<ul>
<li><p><strong>代理模式 Proxy</strong></p>
<p>客户通过代理间接地访问对象。</p>
</li>
<li><p><strong>适配器模式 Adapter</strong></p>
<p>将一个类的接口转换成客户希望的另一个接口，使得原本由于接口不兼容而不能一起工作的类能一起工作。</p>
</li>
<li><p><strong>桥接模式 Bridge</strong></p>
<p>用组合代替继承，使得抽象与实现分离，可以独立变化。</p>
</li>
<li><p><strong>装饰模式 Decorator</strong></p>
<p>动态地给对象增加职责，添加额外的功能。</p>
</li>
<li><p><strong>外观模式 Facade</strong></p>
<p>为多个复杂的子系统提供一个一致的接口，使之更容易被访问。</p>
</li>
<li><p><strong>享元模式 Flyweight</strong></p>
<p>运用共享技术，实现大量细粒度对象的复用。</p>
</li>
<li><p><strong>组合模式 Composite</strong></p>
<p>将对象组合成树状层次结构，使客户对单个对象和组合对象的访问具有一致性。</p>
</li>
</ul>
</li>
<li><p><strong>行为型模式：涉及对象间的交互通信以及为对象分配职责的问题。</strong></p>
<ul>
<li><p><strong>模板方法模式 TemplateMethod</strong></p>
<p>定义一个操作中的算法骨架，将其中的一些步骤延迟到子类中实现。</p>
</li>
<li><p><strong>策略模式 Strategy</strong></p>
<p>定义一系列算法并封装。</p>
</li>
<li><p><strong>命令模式 Command</strong></p>
<p>将一个请求封装为一个对象，使请求的发出和执行分离。</p>
</li>
<li><p><strong>责任链模式 ChainOfResponsibility</strong></p>
<p>把请求从链中的一个对象传到下一个对象，直到请求被响应。</p>
</li>
<li><p><strong>状态模式 State</strong></p>
<p>允许一个对象在内部状态变化时改变其行为能力。</p>
</li>
<li><p><strong>观察者模式 Observer</strong></p>
<p>把一个对象的改变通知给其他对象，从而影响其他对象的行为。</p>
</li>
<li><p><strong>中介者模式 Mediator</strong></p>
<p>定义一个中介对象来简化原有对象间的交互，降低耦合度。</p>
</li>
<li><p><strong>迭代器模式 Iterator</strong></p>
<p>提供一种顺序访问聚合对象的方法，不暴露其内部细节。</p>
</li>
<li><p><strong>访问者模式 Visitor</strong></p>
<p>为集合中的每个元素提供多种访问方式。</p>
</li>
<li><p><strong>备忘录模式 Memento</strong></p>
<p>在不破坏封装的前提下保存一个对象的内部状态，以便后续恢复它。</p>
</li>
<li><p><strong>解释器模式 Interpreter</strong></p>
<p>提供定义语言文法、解释句子的解释器。</p>
</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="1-原型模式"><a href="#1-原型模式" class="headerlink" title="1. 原型模式"></a>1. 原型模式</h4><blockquote>
<p><strong>当某些类的初始化需要消耗非常多资源、<code>new</code>一个对象需要非常繁琐的数据准备和访问权限、一个对象需要在多个场合被访问且访问者可能修改其值时，可以考虑原型模式。</strong></p>
<ul>
<li>原型模式是<strong>内存中的二进制流的拷贝</strong>，比<code>new</code>性能高得多。</li>
<li>由原型生成对象<strong>避免了构造函数的约束</strong>，优缺点共存。</li>
</ul>
<p><strong>使用方式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test.java</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span> &#123;</span><br><span class="line">    MyClass() &#123; System.out.println(<span class="string">&quot;Create prototype success.&quot;</span>); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> <span class="built_in">super</span>.clone();</span><br><span class="line">        System.out.println(<span class="string">&quot;Clone prototype success.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> (MyClass)o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">c2</span> <span class="operator">=</span> (MyClass)c1.clone();</span><br><span class="line">        <span class="comment">// test</span></span><br><span class="line">        System.out.println(c1 == c2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="2-策略模式"><a href="#2-策略模式" class="headerlink" title="2. 策略模式"></a>2. 策略模式</h4><blockquote>
<p><strong>当程序的主要类不希望暴露复杂而具体的数据结构和算法实现时，可以考虑策略模式。</strong></p>
<ul>
<li>上下文和具体策略是<strong>松耦合关系</strong>。</li>
<li>策略模式遵循<strong>“开-闭原则”</strong>，增加新的策略时不需要改动原有代码。</li>
<li>策略模式采用<strong>组合结构</strong>，具有<strong>可扩展性和复用性</strong>。</li>
</ul>
</blockquote>
<ul>
<li><p><strong>策略：一个接口</strong></p>
<p>策略接口定义了若干个算法标识，即声明了若干抽象函数。</p>
</li>
<li><p><strong>上下文：依赖于策略接口的类</strong></p>
<p>上下文包含有用策略声明的变量。上下文提供一个函数，该函数委托策略变量调用具体策略所实现的策略接口中的函数。</p>
</li>
<li><p><strong>具体策略：实现策略接口的类</strong></p>
<p>具体策略类中实现了若干具体的算法。</p>
</li>
</ul>
<blockquote>
<p><strong>举例应用：多个裁判给选手打分，用不同的方案计算最终得分。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Strategy.java 策略</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line"> <span class="type">double</span> <span class="title function_">calcScore</span><span class="params">(<span class="type">double</span>[] scores)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AverageScore.java 上下文</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AverageScore</span> &#123;</span><br><span class="line"> <span class="keyword">private</span> Strategy s;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStrategy</span><span class="params">(Strategy s)</span> &#123; <span class="built_in">this</span>.s = s; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getScore</span><span class="params">(<span class="type">double</span>[] scores)</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (s == <span class="literal">null</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">     <span class="keyword">else</span> <span class="keyword">return</span> s.calcScore(scores);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// StrategyA.java  具体策略 A</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StrategyA</span> <span class="keyword">implements</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calcScore</span><span class="params">(<span class="type">double</span>[] scores)</span> &#123;</span><br><span class="line">     <span class="type">double</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">for</span> (<span class="type">double</span> score : scores) sum += score;</span><br><span class="line">     <span class="keyword">return</span> sum / scores.length;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// StrategyB.java  具体策略 B</span></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StrategyB</span> <span class="keyword">implements</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calcScore</span><span class="params">(<span class="type">double</span>[] scores)</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (scores.length &lt;= <span class="number">2</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">StrategyA</span>().calcScore(scores);</span><br><span class="line">     <span class="type">double</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">     Arrays.sort(scores);</span><br><span class="line">     <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; scores.length - <span class="number">1</span>; i++) sum += scores[i];</span><br><span class="line">     <span class="keyword">return</span> sum / (scores.length - <span class="number">2</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     <span class="type">double</span>[] scores = &#123;<span class="number">92.5</span>, <span class="number">93</span>, <span class="number">89</span>, <span class="number">90.5</span>, <span class="number">96</span>, <span class="number">88.5</span>&#125;;</span><br><span class="line">     <span class="type">AverageScore</span> <span class="variable">as</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AverageScore</span>();</span><br><span class="line">     as.setStrategy(<span class="keyword">new</span> <span class="title class_">StrategyA</span>());</span><br><span class="line">     System.out.println(as.getScore(scores));</span><br><span class="line">     as.setStrategy(<span class="keyword">new</span> <span class="title class_">StrategyB</span>());</span><br><span class="line">     System.out.println(as.getScore(scores));</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="3-访问者模式"><a href="#3-访问者模式" class="headerlink" title="3. 访问者模式"></a>3. 访问者模式</h4><blockquote>
<p><strong>当需要对集合中的元素进行很多不同且不相关的操作时，可以考虑访问者模式。</strong></p>
<ul>
<li>在不改变集合元素的类的情况下，可以添加新的施加于该元素的操作。</li>
<li>具有一定的可扩展性。</li>
</ul>
</blockquote>
<ul>
<li><strong>此模式包含四个角色</strong><ul>
<li>抽象元素：被访问的元素，该元素必须提供允许访问者访问它的接口。</li>
<li>具体元素：被访问的对象，即抽象元素的实现类。</li>
<li>抽象访问者：规定访问时的操作。</li>
<li>具体访问者：实现访问时的操作。</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>举例应用：抄录一个电表，分别按照家用电标准（6000 度以下 0.6 元&#x2F;度；以上 1.05 元&#x2F;度）和企业用电标准（15000 度以下 1.52 元&#x2F;度；以上 2.78 元&#x2F;度）计费。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Visitor.java 抽象访问者</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Visitor</span> &#123;</span><br><span class="line"> <span class="type">int</span> <span class="variable">HOME_STANDARD_AMOUNT</span> <span class="operator">=</span> <span class="number">6000</span>;</span><br><span class="line"> <span class="type">double</span> <span class="variable">HOME_STANDARD_LEVEL_1</span> <span class="operator">=</span> <span class="number">0.6</span>; </span><br><span class="line"> <span class="type">double</span> <span class="variable">HOME_STANDARD_LEVEL_2</span> <span class="operator">=</span> <span class="number">1.05</span>;</span><br><span class="line"></span><br><span class="line"> <span class="type">int</span> <span class="variable">INDUSTRY_STANDARD_AMOUNT</span> <span class="operator">=</span> <span class="number">15000</span>;</span><br><span class="line"> <span class="type">double</span> <span class="variable">INDUSTRY_STANDARD_LEVEL_1</span> <span class="operator">=</span> <span class="number">1.52</span>; </span><br><span class="line"> <span class="type">double</span> <span class="variable">INDUSTRY_STANDARD_LEVEL_2</span> <span class="operator">=</span> <span class="number">2.78</span>; </span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">visit</span><span class="params">(Element e)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HomeVisitor.java 具体访问者 1</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HomeVisitor</span> <span class="keyword">implements</span> <span class="title class_">Visitor</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">visit</span><span class="params">(Element e)</span> &#123;		<span class="comment">// 一种访问操作</span></span><br><span class="line">     <span class="type">double</span> <span class="variable">fee</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">     <span class="type">double</span> <span class="variable">amt</span> <span class="operator">=</span> e.showAmount();</span><br><span class="line">     <span class="keyword">if</span> (amt &lt;= HOME_STANDARD_AMOUNT) fee = amt * HOME_STANDARD_LEVEL_1;</span><br><span class="line">     <span class="keyword">else</span> </span><br><span class="line">         fee = HOME_STANDARD_AMOUNT * HOME_STANDARD_LEVEL_1</span><br><span class="line">            		+ (amt - HOME_STANDARD_AMOUNT) * HOME_STANDARD_LEVEL_2;</span><br><span class="line">        <span class="keyword">return</span> fee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IndustryVisitor.java 具体访问者 2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndustryVisitor</span> <span class="keyword">implements</span> <span class="title class_">Visitor</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">visit</span><span class="params">(Element e)</span> &#123;		<span class="comment">// 另一种访问操作</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">fee</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">amt</span> <span class="operator">=</span> e.showAmount();</span><br><span class="line">        <span class="keyword">if</span> (amt &lt;= INDUSTRY_STANDARD_AMOUNT) </span><br><span class="line">            fee = amt * INDUSTRY_STANDARD_LEVEL_1;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            fee = INDUSTRY_STANDARD_AMOUNT * INDUSTRY_STANDARD_LEVEL_1</span><br><span class="line">            + (amt - INDUSTRY_STANDARD_AMOUNT) * INDUSTRY_STANDARD_LEVEL_2;</span><br><span class="line">        <span class="keyword">return</span> fee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Element.java 抽象元素</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Element</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Visitor v)</span>;</span><br><span class="line">    <span class="type">double</span> <span class="title function_">showAmount</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setAmount</span><span class="params">(<span class="type">double</span> amt)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Ammeter.java 具体元素</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Ammeter</span> <span class="keyword">implements</span> <span class="title class_">Element</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> amount;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Visitor v)</span> &#123;		<span class="comment">// 接收访问者</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">fee</span> <span class="operator">=</span> v.visit(<span class="built_in">this</span>);		<span class="comment">// 让访问者访问自己</span></span><br><span class="line">        System.out.printf(<span class="string">&quot;Electric fee: %.2f\n&quot;</span>, fee);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAmount</span><span class="params">(<span class="type">double</span> amt)</span> &#123; amount = amt; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">showAmount</span><span class="params">()</span> &#123; <span class="keyword">return</span> amount; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Ammeter</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Ammeter</span>(); a.setAmount(<span class="number">6723</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Visitor</span> <span class="variable">v</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HomeVisitor</span>();</span><br><span class="line">        a.accept(v);</span><br><span class="line">        v = <span class="keyword">new</span> <span class="title class_">IndustryVisitor</span>();</span><br><span class="line">        a.accept(v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="4-装饰模式"><a href="#4-装饰模式" class="headerlink" title="4. 装饰模式"></a>4. 装饰模式</h4><blockquote>
<p><strong>当希望动态地增强某个类的某个对象的功能，同时不影响该类其他对象的时候，可以考虑装饰模式。</strong></p>
<ul>
<li>被装饰者和装饰者是<strong>松耦合关系</strong>。</li>
<li>装饰者不知道自己要装饰哪个类的哪个对象，相比于用继承生成子类更加<strong>灵活</strong>。</li>
<li>装饰模式使得程序的<strong>弹性和可扩展性更</strong>优，不影响系统的扩展和维护。</li>
</ul>
</blockquote>
<ul>
<li><strong>此模式包含四个角色</strong><ul>
<li>抽象组件：声明了需要装饰的函数，即“被装饰者”的抽象。</li>
<li>具体组件：实际装饰的对象，是抽象组建的实现类。</li>
<li>装饰：抽象组建的子类，用于进行装饰。</li>
<li>具体装饰：装饰的非抽象子类，用于定义装饰的内容。</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>举例应用：给 C919 加装油箱，使其航程从 5500 km 提升至 8000 km。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Flyer.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Flyer</span> &#123;</span><br><span class="line"> <span class="type">int</span> <span class="title function_">fly</span><span class="params">()</span>;				<span class="comment">// 需要装饰的函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C919.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">C919</span> <span class="keyword">implements</span> <span class="title class_">Flyer</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">AIR_RANGE</span> <span class="operator">=</span> <span class="number">5500</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">fly</span><span class="params">()</span> &#123; <span class="keyword">return</span> AIR_RANGE; &#125;	<span class="comment">// 装饰前的函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Decorator.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Decorator</span> <span class="keyword">implements</span> <span class="title class_">Flyer</span> &#123;</span><br><span class="line"> <span class="keyword">protected</span> Flyer f;		<span class="comment">// 抽象的装饰包办被装饰对象的引用</span></span><br><span class="line"> <span class="keyword">public</span> <span class="title function_">Decorator</span><span class="params">(Flyer f)</span> &#123; <span class="built_in">this</span>.f = f; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">int</span> <span class="title function_">fly</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FuelTankDecorator.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FuelTankDecorator</span> <span class="keyword">extends</span> <span class="title class_">Decorator</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">AIR_RANGE_ADDED</span> <span class="operator">=</span> <span class="number">2500</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="title function_">FuelTankDecorator</span><span class="params">(Flyer f)</span> &#123; <span class="built_in">super</span>(f); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">fly</span><span class="params">()</span> &#123;		<span class="comment">// 用于装饰的函数</span></span><br><span class="line">     <span class="keyword">return</span> f.fly() + flyWithMoreFuel();		<span class="comment">// 进行具体的装饰过程</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">flyWithMoreFuel</span><span class="params">()</span> &#123; <span class="keyword">return</span> AIR_RANGE_ADDED; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     <span class="type">Flyer</span> <span class="variable">c919</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">C919</span>();</span><br><span class="line">     System.out.println</span><br><span class="line">         (<span class="string">&quot;C919 can fly &quot;</span> + c919.fly() + <span class="string">&quot; km without added fuel.&quot;</span>);</span><br><span class="line">     c919 = <span class="keyword">new</span> <span class="title class_">FuelTankDecorator</span>(c919);		<span class="comment">// 进行装饰</span></span><br><span class="line">     System.out.println</span><br><span class="line">         (<span class="string">&quot;C919 can fly &quot;</span> + c919.fly() + <span class="string">&quot; km with added fuel.&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="5-适配器模式"><a href="#5-适配器模式" class="headerlink" title="5. 适配器模式"></a>5. 适配器模式</h4><blockquote>
<p><strong>当想要使用一个已经存在的类，但是该类不符合现有接口规范而无法直接访问，可以通过适配器间接访问；当设计出一个新类并希望它将来可以在多种场合下被重用，可以为之创建一系列适配器。</strong></p>
<ul>
<li>将目标与被适配者<strong>解耦</strong>，无需重构被适配者。</li>
<li>将业务封装在适配器中，提高了<strong>透明度和复用性</strong>。</li>
<li>遵循<strong>“开闭原则”</strong>，灵活性和可扩展性好。</li>
</ul>
</blockquote>
<ul>
<li><strong>此模式包含三种角色</strong><ul>
<li>目标：用户想使用的接口。</li>
<li>被适配者：已经存在的、需要适配的接口或抽象类。</li>
<li>适配器：此类实现了目标，并包含被适配者的引用，用于进行适配。</li>
</ul>
</li>
<li><strong>适配器的适配程度</strong><ul>
<li>完全适配：目标中的函数数目等于被适配者中的函数数目。</li>
<li>不完全适配：目标中的函数数目小于被适配者中的函数数目。</li>
<li>剩余适配：目标中的函数数目大于被适配者中的函数数目，这种情况下用户必须给出多出的那些函数的实现。</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>举例应用：用户家里有台使用交流电的洗衣机，现在用户买了一台只能用直流电的录音机，需要进行转化。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DC.java 目标</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DC</span> &#123;</span><br><span class="line"> String <span class="title function_">giveDC</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AC.java 被适配者</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AC</span> &#123;</span><br><span class="line"> String <span class="title function_">giveAC</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Adapter.java 适配器</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Adapter</span> <span class="keyword">implements</span> <span class="title class_">DC</span> &#123;</span><br><span class="line"> <span class="keyword">private</span> AC ac;</span><br><span class="line"> Adapter(AC ac) &#123; <span class="built_in">this</span>.ac = ac; &#125;</span><br><span class="line"> <span class="keyword">public</span> String <span class="title function_">giveDC</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="type">String</span> <span class="variable">in</span> <span class="operator">=</span> ac.giveAC();</span><br><span class="line">     <span class="type">StringBuffer</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(in);</span><br><span class="line">     <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; out.length(); i++)</span><br><span class="line">         <span class="keyword">if</span> (out.charAt(i) == <span class="string">&#x27;0&#x27;</span>) out.setCharAt(i, <span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(out);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PowerProvider.java 被适配者的具体实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PowerProvider</span> <span class="keyword">implements</span> <span class="title class_">AC</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> String <span class="title function_">giveAC</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="string">&quot;1010101010101010...&quot;</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Application.java</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WashingMachine</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">work</span><span class="params">(AC ac)</span> &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;Turn on the washing machine &quot;</span> + ac.giveAC());</span><br><span class="line">     System.out.println(<span class="string">&quot;Start washing...&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Recorder</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">work</span><span class="params">(DC dc)</span> &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;Turn on the recorder &quot;</span> + dc.giveDC());</span><br><span class="line">     System.out.println(<span class="string">&quot;Start recording...&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     <span class="type">AC</span> <span class="variable">ac</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PowerProvider</span>();</span><br><span class="line">     <span class="type">WashingMachine</span> <span class="variable">wm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WashingMachine</span>();</span><br><span class="line">     wm.work(ac);</span><br><span class="line"></span><br><span class="line">     <span class="type">DC</span> <span class="variable">dc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Adapter</span>(ac);</span><br><span class="line">     <span class="type">Recorder</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Recorder</span>();</span><br><span class="line">     r.work(dc);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="6-责任链模式"><a href="#6-责任链模式" class="headerlink" title="6. 责任链模式"></a>6. 责任链模式</h4><blockquote>
<p><strong>当有多个类用于处理用户请求并希望动态制定处理请求的逻辑时，可以考虑责任链模式。</strong></p>
<ul>
<li>将命令发出者和执行者<strong>解耦</strong>。</li>
<li>可灵活地为不同处理者分配职责。</li>
</ul>
</blockquote>
<ul>
<li><strong>此模式包含两种角色</strong><ul>
<li>处理者</li>
<li>具体处理者</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>举例应用：模拟一个学生请假的情形。假设天数小于等于 2 天，班主任可以批准；小于等于 7 天，系主任可以批准；小于等于 10 天，院长可以批准；更多的天数原则上不再批准。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test.java</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Handler</span> &#123;					<span class="comment">// 抽象处理者</span></span><br><span class="line"> <span class="keyword">private</span> Handler next;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNext</span><span class="params">(Handler next)</span> &#123; <span class="built_in">this</span>.next = next; &#125;</span><br><span class="line"> <span class="keyword">public</span> Handler <span class="title function_">getNext</span><span class="params">()</span> &#123; <span class="keyword">return</span> next; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(<span class="type">int</span> days)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ClassAdviser</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;	   <span class="comment">// 处理者 1</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(<span class="type">int</span> days)</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (days &lt;= <span class="number">2</span>) </span><br><span class="line">         System.out.println(<span class="string">&quot;The class adviser allows you &quot;</span> </span><br><span class="line">                               + days + <span class="string">&quot; days.&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (getNext() != <span class="literal">null</span>)</span><br><span class="line">            getNext().handle(days);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Request not allowed.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DepartmentHead</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;		<span class="comment">// 处理者 2</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(<span class="type">int</span> days)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (days &lt;= <span class="number">7</span>) </span><br><span class="line">            System.out.println(<span class="string">&quot;The department head allows you &quot;</span> </span><br><span class="line">                               + days + <span class="string">&quot; days.&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (getNext() != <span class="literal">null</span>)</span><br><span class="line">            getNext().handle(days);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Request not allowed.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dean</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;				 <span class="comment">// 处理者 3</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(<span class="type">int</span> days)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (days &lt;= <span class="number">10</span>) </span><br><span class="line">            System.out.println(<span class="string">&quot;The dean allows you &quot;</span> </span><br><span class="line">                               + days + <span class="string">&quot; days.&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (getNext() != <span class="literal">null</span>)</span><br><span class="line">            getNext().handle(days);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Request not allowed.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// ----------- 组装责任链 -----------</span></span><br><span class="line">        <span class="type">Handler</span> <span class="variable">h1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassAdviser</span>();</span><br><span class="line">        <span class="type">Handler</span> <span class="variable">h2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DepartmentHead</span>();</span><br><span class="line">        <span class="type">Handler</span> <span class="variable">h3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dean</span>();</span><br><span class="line">        h1.setNext(h2);</span><br><span class="line">        h2.setNext(h3);</span><br><span class="line">        <span class="comment">// --------------------------------</span></span><br><span class="line"></span><br><span class="line">        h1.handle(<span class="number">8</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="7-外观模式（门面模式）"><a href="#7-外观模式（门面模式）" class="headerlink" title="7. 外观模式（门面模式）"></a>7. 外观模式（门面模式）</h4><blockquote>
<p><strong>当需要为多个子系统提供一个一致的接口便于外界访问时，可以考虑外观模式。</strong></p>
<p>外观模式是<strong>迪米特法则</strong>的典型应用，其优点是</p>
<ul>
<li>对客户屏蔽了子系统组件，<strong>降低耦合度</strong>，并使得客户的使用更加容易。</li>
<li>编译一个子系统不影响其他子系统，也不影响外观类，<strong>降低了大型软件系统的编译依赖性，简化了系统在不同平台间的移植过程</strong>。</li>
</ul>
<p>外观模式<strong>大量使用组合</strong>，其缺点是</p>
<ul>
<li>对子系统的修改或增加新的子系统可能需要修改外观类或客户端，<strong>违背了“开-闭原则”</strong>。</li>
<li>不能很好地限制用户直接使用子系统类，<strong>易带来未知风险</strong>。</li>
</ul>
</blockquote>
<ul>
<li><strong>此模式包含三种角色</strong><ul>
<li>外观类：提供给用户的统一接口</li>
<li>子系统：一系列具体的实现任务的类</li>
<li>客户端：外观的调用者</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>举例应用：家庭影院的模拟。家庭影院包含播放器、音响、屏幕、投影仪四部分。用户希望通过遥控器一键启动、暂停、结束等，而非逐个部件地操作。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HomeTheater.java</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Player</span> &#123;				<span class="comment">// 子系统 1：播放器</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Player</span> <span class="variable">ins</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Player</span>();</span><br><span class="line"> <span class="keyword">private</span> <span class="title function_">Player</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Player <span class="title function_">getInstance</span><span class="params">()</span> &#123; <span class="keyword">return</span> ins; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">on</span><span class="params">()</span>        &#123; System.out.println(<span class="string">&quot;播放器打开了&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">off</span><span class="params">()</span>      	&#123; System.out.println(<span class="string">&quot;播放器关闭了&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">play</span><span class="params">()</span>      &#123; System.out.println(<span class="string">&quot;播放器正在播放&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pause</span><span class="params">()</span>     &#123; System.out.println(<span class="string">&quot;播放器暂停&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stereo</span> &#123;				<span class="comment">// 子系统 2：音响</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Stereo</span> <span class="variable">ins</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Stereo</span>();</span><br><span class="line"> <span class="keyword">private</span> <span class="title function_">Stereo</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Stereo <span class="title function_">getInstance</span><span class="params">()</span> &#123; <span class="keyword">return</span> ins; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">on</span><span class="params">()</span>        &#123; System.out.println(<span class="string">&quot;音响打开了&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">off</span><span class="params">()</span>       &#123; System.out.println(<span class="string">&quot;音响关闭了&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">play</span><span class="params">()</span>      &#123; System.out.println(<span class="string">&quot;音响正在播放&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pause</span><span class="params">()</span>     &#123; System.out.println(<span class="string">&quot;音响暂停&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">adjust</span><span class="params">()</span>    &#123; System.out.println(<span class="string">&quot;调节音量中&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Screen</span> &#123;				<span class="comment">// 子系统 3：屏幕</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Screen</span> <span class="variable">ins</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Screen</span>();</span><br><span class="line"> <span class="keyword">private</span> <span class="title function_">Screen</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Screen <span class="title function_">getInstance</span><span class="params">()</span> &#123; <span class="keyword">return</span> ins; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">up</span><span class="params">()</span>	&#123; System.out.println(<span class="string">&quot;屏幕上升&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">down</span><span class="params">()</span> 	&#123; System.out.println(<span class="string">&quot;屏幕下降&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Projector</span> &#123;			<span class="comment">// 子系统 4：投影仪</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Projector</span> <span class="variable">ins</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Projector</span>();</span><br><span class="line"> <span class="keyword">private</span> <span class="title function_">Projector</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Projector <span class="title function_">getInstance</span><span class="params">()</span> &#123; <span class="keyword">return</span> ins; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">on</span><span class="params">()</span> 	&#123; System.out.println(<span class="string">&quot;投影仪打开了&quot;</span>); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">off</span><span class="params">()</span>   &#123; System.out.println(<span class="string">&quot;投影仪关闭了&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HomeTheater</span> &#123;	<span class="comment">// 外观类：家庭影院</span></span><br><span class="line"> <span class="keyword">private</span> <span class="type">Player</span> <span class="variable">player</span> <span class="operator">=</span> Player.getInstance();</span><br><span class="line"> <span class="keyword">private</span> <span class="type">Stereo</span> <span class="variable">stereo</span> <span class="operator">=</span> Stereo.getInstance();</span><br><span class="line"> <span class="keyword">private</span> <span class="type">Screen</span> <span class="variable">screen</span> <span class="operator">=</span> Screen.getInstance();</span><br><span class="line"> <span class="keyword">private</span> <span class="type">Projector</span> <span class="variable">projector</span> <span class="operator">=</span> Projector.getInstance();</span><br><span class="line"> <span class="comment">// 提供服务</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ready</span><span class="params">()</span> &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;=== READY ===&quot;</span>);</span><br><span class="line">     screen.down(); player.on(); stereo.on(); projector.on(); stereo.adjust();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">play</span><span class="params">()</span> &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;=== PLAY ===&quot;</span>);</span><br><span class="line">     player.play(); stereo.play();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pause</span><span class="params">()</span> &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;=== PAUSE ===&quot;</span>);</span><br><span class="line">     player.pause(); stereo.pause();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">end</span><span class="params">()</span> &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;=== END ===&quot;</span>);</span><br><span class="line">     player.off(); stereo.off(); projector.off(); screen.up();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Client.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     <span class="type">HomeTheater</span> <span class="variable">ht</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HomeTheater</span>();</span><br><span class="line">     ht.ready(); ht.play(); ht.pause(); ht.end();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="8-工厂模式"><a href="#8-工厂模式" class="headerlink" title="8. 工厂模式"></a>8. 工厂模式</h4><ul>
<li><h5 id="简单工厂：为产品创建工厂类，客户调用工厂的函数获得产品。"><a href="#简单工厂：为产品创建工厂类，客户调用工厂的函数获得产品。" class="headerlink" title="简单工厂：为产品创建工厂类，客户调用工厂的函数获得产品。"></a>简单工厂：为产品创建工厂类，客户调用工厂的函数获得产品。</h5><blockquote>
<p><strong>举例应用：模拟女娲造人。传入参数 M 或 m 创造男人，传入 W 或 w 创造女人。其他种类暂时无法创造。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Person.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"> <span class="keyword">void</span> <span class="title function_">create</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Nvwa.java</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Man</span> <span class="keyword">implements</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"> Man() &#123; create(); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">create</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;Create a man.&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Woman</span> <span class="keyword">implements</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"> Woman() &#123; create(); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">create</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;Create a woman.&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Nvwa</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Person <span class="title function_">create</span><span class="params">(String p)</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (p.equalsIgnoreCase(<span class="string">&quot;M&quot;</span>)) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Man</span>();</span><br><span class="line">     <span class="keyword">else</span> <span class="keyword">if</span> (p.equalsIgnoreCase(<span class="string">&quot;W&quot;</span>)) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Woman</span>();</span><br><span class="line">     <span class="keyword">else</span> &#123;</span><br><span class="line">         System.out.println(<span class="string">&quot;Sorry, I can&#x27;t create &quot;</span> + p + <span class="string">&quot;.&quot;</span>);</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SimpleFactoryTest.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleFactoryTest</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     <span class="type">Person</span> <span class="variable">p1</span> <span class="operator">=</span> Nvwa.create(<span class="string">&quot;M&quot;</span>);</span><br><span class="line">     <span class="type">Person</span> <span class="variable">p2</span> <span class="operator">=</span> Nvwa.create(<span class="string">&quot;W&quot;</span>);</span><br><span class="line">     <span class="type">Person</span> <span class="variable">p3</span> <span class="operator">=</span> Nvwa.create(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><h5 id="工厂方法"><a href="#工厂方法" class="headerlink" title="工厂方法"></a>工厂方法</h5><ul>
<li><strong>此模式包含四种角色</strong><ul>
<li>抽象产品</li>
<li>具体产品</li>
<li>抽象生产者</li>
<li>具体生产者</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>举例应用：生产黑色和红色的笔芯。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PenCore.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">PenCore</span> &#123;</span><br><span class="line"> <span class="keyword">protected</span> String color;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeDown</span><span class="params">(String s)</span> &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;Write down &quot;</span> + color + <span class="string">&quot; words: &quot;</span> + s);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BlackPenCore</span> <span class="keyword">extends</span> <span class="title class_">PenCore</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="title function_">BlackPenCore</span><span class="params">()</span> &#123; color = <span class="string">&quot;black&quot;</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RedPenCore</span> <span class="keyword">extends</span> <span class="title class_">PenCore</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="title function_">RedPenCore</span><span class="params">()</span> &#123; color = <span class="string">&quot;red&quot;</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PenCoreCreator.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">PenCoreCreator</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">abstract</span> PenCore <span class="title function_">getPenCore</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BlackPenCoreCreator</span> <span class="keyword">extends</span> <span class="title class_">PenCoreCreator</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> PenCore <span class="title function_">getPenCore</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BlackPenCore</span>(); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RedPenCoreCreator</span> <span class="keyword">extends</span> <span class="title class_">PenCoreCreator</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> PenCore <span class="title function_">getPenCore</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RedPenCore</span>(); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FactoryMethodTest.java</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BallPen</span> &#123;</span><br><span class="line"> PenCore pc;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPenCore</span><span class="params">(PenCore pc)</span> &#123; <span class="built_in">this</span>.pc = pc; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(String s)</span> &#123; pc.writeDown(s); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FactoryMethodTest</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     PenCoreCreator pcc;</span><br><span class="line">     <span class="type">BallPen</span> <span class="variable">pen</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BallPen</span>();</span><br><span class="line"></span><br><span class="line">     pcc = <span class="keyword">new</span> <span class="title class_">BlackPenCoreCreator</span>();</span><br><span class="line">     pen.setPenCore(pcc.getPenCore());</span><br><span class="line">     pen.write(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">     pcc = <span class="keyword">new</span> <span class="title class_">RedPenCoreCreator</span>();</span><br><span class="line">     pen.setPenCore(pcc.getPenCore());</span><br><span class="line">     pen.write(<span class="string">&quot;World&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><h5 id="抽象工厂：更高层次抽象的工厂方法"><a href="#抽象工厂：更高层次抽象的工厂方法" class="headerlink" title="抽象工厂：更高层次抽象的工厂方法"></a>抽象工厂：更高层次抽象的工厂方法</h5><blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	上例可以用工厂方法解决，其特性是一个工厂、多种产品。可以为之赋予如下实际含义：</span></span><br><span class="line"><span class="comment">	---------------------------</span></span><br><span class="line"><span class="comment">     [品牌]       [产品]</span></span><br><span class="line"><span class="comment">      晨光     圆珠笔(黑/红)</span></span><br><span class="line"><span class="comment">	---------------------------</span></span><br><span class="line"><span class="comment">	对应的类的结构为</span></span><br><span class="line"><span class="comment">		[abstract class] PenCore &lt;-实现- [class] BlackPenCore &amp; RedPenCore</span></span><br><span class="line"><span class="comment">		[abstract class] PenCoreCreator &lt;-实现- [class] BPCC &amp; RPCC</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	考虑另一种情形。假设有多个工厂(品牌)，生产多种产品，则需要对工厂进一步抽象。例如：</span></span><br><span class="line"><span class="comment">	---------------------------------------------</span></span><br><span class="line"><span class="comment">		[品牌]         [产品1]         [产品2]</span></span><br><span class="line"><span class="comment">		 晨光        圆珠笔(黑/红)  笔记本(横线/网格)</span></span><br><span class="line"><span class="comment">	     Muji       圆珠笔(黑/红)  笔记本(横线/网格)</span></span><br><span class="line"><span class="comment">	---------------------------------------------</span></span><br><span class="line"><span class="comment">	对应的结构应设置为</span></span><br><span class="line"><span class="comment">		[abstract class] AbstractCreator</span></span><br><span class="line"><span class="comment">			- createBallPen(color)</span></span><br><span class="line"><span class="comment">			- createNotebook(type)</span></span><br><span class="line"><span class="comment">		[class] CreatorNamedChenguang extends AbstractCreator</span></span><br><span class="line"><span class="comment">		[class] CreatorNamedMuji extends AbstractCreator</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		[abstract class] BallPen</span></span><br><span class="line"><span class="comment">			- color</span></span><br><span class="line"><span class="comment">			- writeDown()</span></span><br><span class="line"><span class="comment">		[class] BallPenOfChenguang extends BallPen</span></span><br><span class="line"><span class="comment">		[class] BallPenOfMuji extends BallPen</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		[abstract class] Notebook</span></span><br><span class="line"><span class="comment">			- type</span></span><br><span class="line"><span class="comment">			- beWritten()</span></span><br><span class="line"><span class="comment">		[class] NotebookOfChenguang extends Notebook</span></span><br><span class="line"><span class="comment">		[class] NotebookOfMuji extends Notebook</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h4 id="9-观察者模式（监听模式）"><a href="#9-观察者模式（监听模式）" class="headerlink" title="9. 观察者模式（监听模式）"></a>9. 观察者模式（监听模式）</h4><blockquote>
<p><strong>当程序中的对象需要通知其他对象，希望建立一种链式触发机制时，可以考虑观察者模式。</strong></p>
<p><strong>此模式的优点</strong></p>
<ul>
<li>一个对象的改变将导致其他一个或多个对象的改变，但是这个发生改变的对象<strong>无需关心</strong>其他这些对象的细节，也不用知道他们是谁。</li>
<li>观察者和被观察者<strong>仅在抽象层次上耦合</strong>。</li>
</ul>
<p><strong>此模式的缺点</strong></p>
<ul>
<li>如果一个被观察者有很多直接和间接的观察者，则全部通知需要<strong>花费很多时间</strong>。</li>
<li>如果被观察者和观察者存在<strong>循环依赖</strong>的话，可能会触发循环通知，导致系统崩溃。</li>
</ul>
</blockquote>
<ul>
<li><strong>此模式包含四种角色</strong><ul>
<li>抽象主题：抽象的被观察者，声明了增加、删除、通知观察者的函数。</li>
<li>具体主题：抽象主题的实现类。</li>
<li>抽象观察者：声明了更新自己的函数。</li>
<li>具体观察者：抽象观察者的实现类。</li>
</ul>
</li>
</ul>
<blockquote>
<p>举例应用：模拟微信公众号更新推送，通知所有用户的过程。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Subject.java</span></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Subject</span> &#123;                        <span class="comment">// 抽象主题</span></span><br><span class="line"> <span class="keyword">void</span> <span class="title function_">attach</span><span class="params">(Observer obs)</span>;	<span class="comment">// 增加订阅者</span></span><br><span class="line"> <span class="keyword">void</span> <span class="title function_">detach</span><span class="params">(Observer obs)</span>;	<span class="comment">// 删除订阅者</span></span><br><span class="line"> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(String msg)</span>;	<span class="comment">// 通知订阅者</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SubscriptionSubject</span> <span class="keyword">implements</span> <span class="title class_">Subject</span> &#123;    <span class="comment">// 具体主题</span></span><br><span class="line"> <span class="keyword">private</span> List&lt;Observer&gt; userList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Observer&gt;();</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attach</span><span class="params">(Observer obs)</span> &#123; userList.add(obs); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detach</span><span class="params">(Observer obs)</span> &#123; userList.remove(obs); &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">     <span class="keyword">for</span> (Observer obs : userList)</span><br><span class="line">         obs.update(msg);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Observer.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Observer</span> &#123;                       <span class="comment">// 抽象观察者</span></span><br><span class="line"> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String msg)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WeChatUser</span> <span class="keyword">implements</span> <span class="title class_">Observer</span> &#123;            <span class="comment">// 具体观察者</span></span><br><span class="line"> <span class="keyword">private</span> String name;</span><br><span class="line"> <span class="keyword">public</span> <span class="title function_">WeChatUser</span><span class="params">(String name)</span> &#123; <span class="built_in">this</span>.name = name; &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String msg)</span> &#123; System.out.println(name + <span class="string">&quot; \&quot;&quot;</span> + msg + <span class="string">&quot;\&quot;&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     <span class="type">Subject</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubscriptionSubject</span>();</span><br><span class="line"></span><br><span class="line">     <span class="type">WeChatUser</span> <span class="variable">user1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WeChatUser</span>(<span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">     <span class="type">WeChatUser</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WeChatUser</span>(<span class="string">&quot;John&quot;</span>);</span><br><span class="line">     <span class="type">WeChatUser</span> <span class="variable">user3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WeChatUser</span>(<span class="string">&quot;Kate&quot;</span>);</span><br><span class="line"></span><br><span class="line">     s.attach(user1);</span><br><span class="line">     s.attach(user2);</span><br><span class="line">     s.attach(user3);</span><br><span class="line"></span><br><span class="line">     s.notify(<span class="string">&quot;Update&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="八、集合框架"><a href="#八、集合框架" class="headerlink" title="八、集合框架"></a>八、集合框架</h2><p><img src="https://github.com/Pan-Pan-Pan/AssetsForBlog/tree/main/OOP/3.png"></p>
<h3 id="1-集合框架概述"><a href="#1-集合框架概述" class="headerlink" title="1. 集合框架概述"></a>1. 集合框架概述</h3><ul>
<li><p><strong>含义</strong></p>
<p><strong>集合框架是为表示和操作集合而规定的一种统一的、标准的体系结构。</strong></p>
</li>
<li><p><strong>集合框架的三大组成部分</strong></p>
<ul>
<li>接口：表示集合的抽象数据类型</li>
<li>实现：接口的具体实现，即一系列数据结构</li>
<li>算法：含有查找、排序等算法的工具包</li>
</ul>
<blockquote>
<p><strong>说明</strong></p>
<ul>
<li>所有集合类都位于<code>java.util</code>包下。</li>
<li>集合框架可以细化为四个部分<ul>
<li>数据结构：列表<code>List</code>、队列<code>Queue</code>、双端队列<code>Deque</code>、集合<code>Set</code>和映射<code>Map</code></li>
<li>比较器：比较器<code>Comparator</code>和排序接口<code>Comparable</code></li>
<li>算法：常用算法类<code>Collections</code>和静态数组的排序、查找类<code>Arrays</code></li>
<li>迭代器：通用迭代器<code>Iterator</code>和<code>List</code>特化迭代器<code>ListIterator</code></li>
</ul>
</li>
</ul>
</blockquote>
</li>
<li><p><strong>集合类只容纳对象。</strong></p>
</li>
</ul>
<h3 id="2-Collection接口"><a href="#2-Collection接口" class="headerlink" title="2. Collection接口"></a>2. <code>Collection</code>接口</h3><ul>
<li><p><code>Collection</code>接口是<code>List</code>、<code>Set</code>和<code>Queue</code>接口的父接口，是集合框架的<strong>根接口</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Collection 接口中定义的常用函数</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Collection</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Iterable</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">remove</span><span class="params">(E e)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">removeAll</span><span class="params">(Collection&lt;?&gt; c)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(Object obj)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">containsAll</span><span class="params">(Collection&lt;?&gt; c)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>;</span><br><span class="line">    Object[] toArray();</span><br><span class="line">    Iterator <span class="title function_">iterator</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong><code>List</code>接口</strong></p>
<ul>
<li><p><code>List</code>的特征是其元素有<strong>确定的顺序</strong>并且<strong>可以重复</strong>，可以<strong>通过下标访问元素</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// List 接口中新增的函数</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">List</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Collection</span>&lt;E&gt; &#123;</span><br><span class="line">    E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>;</span><br><span class="line">    E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span>;</span><br><span class="line">    E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(Object o)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">lastIndexOf</span><span class="params">(Object o)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">addAll</span><span class="params">(<span class="type">int</span> index, Collection&lt;? extends E&gt; c)</span>;</span><br><span class="line">    ListIterator&lt;E&gt; <span class="title function_">listIterator</span><span class="params">()</span>;</span><br><span class="line">    ListIterator&lt;E&gt; <span class="title function_">listIterator</span><span class="params">(<span class="type">int</span> index)</span>;</span><br><span class="line">    List&lt;E&gt; <span class="title function_">subList</span><span class="params">(<span class="type">int</span> fromIndet, <span class="type">int</span> toIndex)</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>List</code>的实现类有<code>ArrayList</code>和<code>LinkedList</code>。</p>
<ul>
<li><p><code>ArrayList</code>实现了<strong>在内存中连续储存的可变长数组</strong>，<strong>遍历和随机访问元素</strong>的效率较高。</p>
</li>
<li><p><code>LinkedList</code>实现了<strong>链表</strong>，<strong>插入和删除</strong>的效率较高。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// LinkedList 的特殊函数</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addFirst</span><span class="params">(E element)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addLast</span><span class="params">(E element)</span>;</span><br><span class="line">    E <span class="title function_">getFirst</span><span class="params">()</span>;</span><br><span class="line">    E <span class="title function_">getLast</span><span class="params">()</span>;</span><br><span class="line">    E <span class="title function_">removeFirst</span><span class="params">()</span>;</span><br><span class="line">    E <span class="title function_">removeLast</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p><strong><code>Set</code>接口</strong></p>
<ul>
<li><strong><code>Set</code>中的元素必须唯一。</strong></li>
<li>添加到<code>Set</code>中的元素必须定义<code>equals</code>函数，从而保证元素的唯一性。</li>
<li>实现<code>Set</code>接口的类有<code>HashSet</code>、<code>TreeSet</code>等。</li>
</ul>
</li>
</ul>
<h3 id="3-Map接口"><a href="#3-Map接口" class="headerlink" title="3. Map接口"></a>3. <code>Map</code>接口</h3><ul>
<li><p><code>Map</code>接口专门处理<strong>键值对映射数据</strong>的存储，其常用的成员有</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Map</span>&lt;K, V&gt; &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">containsKey</span><span class="params">(Object key)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">containsValue</span><span class="params">(Object value)</span>;</span><br><span class="line">    V <span class="title function_">get</span><span class="params">(Object key)</span>;</span><br><span class="line">    V <span class="title function_">getOrDefault</span><span class="params">(Object key, V defaultValue)</span>;</span><br><span class="line">    	<span class="comment">// 若找到 key 返回其对应的 value，否则返回 defaultVaule</span></span><br><span class="line">    V <span class="title function_">put</span><span class="params">(K key, V value)</span>;</span><br><span class="line">    V <span class="title function_">remove</span><span class="params">(Object key)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">putAll</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>;</span><br><span class="line">    Set&lt;K&gt; <span class="title function_">keySet</span><span class="params">()</span>;</span><br><span class="line">    Collection&lt;V&gt; <span class="title function_">values</span><span class="params">()</span>;</span><br><span class="line">    Set&lt;Map.Entry&lt;K, V&gt;&gt; entrySet();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Entry</span>&lt;K, V&gt; &#123;</span><br><span class="line">        K <span class="title function_">getKey</span><span class="params">()</span>;</span><br><span class="line">        V <span class="title function_">getValue</span><span class="params">()</span>;</span><br><span class="line">        V <span class="title function_">setValue</span><span class="params">()</span>;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong><code>Map</code>的注意事项</strong></p>
<ul>
<li><p><code>Map</code>是接口，<strong>不能直接实例化</strong>。通常选用其子类<code>TreeMap</code>或<code>HashMap</code>。</p>
<table>
<thead>
<tr>
<th align="center"><code>Map</code>实现类</th>
<th align="center"><code>TreeMap</code></th>
<th align="center"><code>HashMap</code></th>
</tr>
</thead>
<tbody><tr>
<td align="center">底层结构</td>
<td align="center">红黑树</td>
<td align="center">哈希桶</td>
</tr>
<tr>
<td align="center">增删查时间复杂度</td>
<td align="center">$O(log_2N)$</td>
<td align="center">$O(1)$</td>
</tr>
<tr>
<td align="center">是否有序</td>
<td align="center">关于<code>key</code>有序</td>
<td align="center">无序</td>
</tr>
<tr>
<td align="center">线程安全性</td>
<td align="center">不安全</td>
<td align="center">不安全</td>
</tr>
<tr>
<td align="center">增删查区别</td>
<td align="center">需要进行元素比较</td>
<td align="center">通过哈希函数计算哈希地址</td>
</tr>
<tr>
<td align="center">注意事项</td>
<td align="center"><code>key</code>必须能够比较，否则抛<code>ClassCastException</code></td>
<td align="center">自定义类型必须重写<code>equals</code>和<code>hashCode</code>函数</td>
</tr>
<tr>
<td align="center">应用场景</td>
<td align="center">需要<code>key</code>有序的情形</td>
<td align="center">关心更高的时间性能</td>
</tr>
</tbody></table>
</li>
<li><p><strong><code>Map</code>中的<code>key</code>是唯一的，<code>value</code>可以重复。</strong>分离<code>key</code>时，将其储存到<code>Set</code>中；分离<code>value</code>时，将其储存到<code>Collection</code>的可包含重复元素的子类中。</p>
</li>
<li><p><strong><code>Map</code>中的<code>key</code>不能修改</strong>，<code>value</code>可以修改。如果想修改<code>key</code>只能先删除后重新插入。</p>
</li>
<li><p><strong><code>Map.Entry</code> —— <code>Map</code>中的每一个元素，即将键值对打包后的类型</strong></p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 Map.Entry 遍历 Map</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     Map&lt;Integer, String&gt; map = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;Integer, String&gt;();</span><br><span class="line">     map.put(<span class="number">10</span>, <span class="string">&quot;hello&quot;</span>); map.put(<span class="number">20</span>, <span class="string">&quot;abc&quot;</span>); map.put(<span class="number">66</span>, <span class="string">&quot;yes&quot;</span>);</span><br><span class="line"></span><br><span class="line">     <span class="keyword">for</span> (Map.Entry&lt;Integer, String&gt; entry : map.entrySet()) &#123;</span><br><span class="line">         System.out.println(<span class="string">&quot;key: &quot;</span> + entry.getKey()</span><br><span class="line">                               + <span class="string">&quot; value: &quot;</span> + entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p><strong>另一种遍历的有效手段</strong></p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 forEach 遍历 Map</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     Map&lt;Integer, String&gt; map = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;Integer, String&gt;();</span><br><span class="line">     map.put(<span class="number">10</span>, <span class="string">&quot;hello&quot;</span>); map.put(<span class="number">20</span>, <span class="string">&quot;abc&quot;</span>); map.put(<span class="number">66</span>, <span class="string">&quot;yes&quot;</span>);</span><br><span class="line"></span><br><span class="line">     map.forEach((key, value) -&gt; &#123;</span><br><span class="line">         System.out.println(<span class="string">&quot;key: &quot;</span> + key + <span class="string">&quot; value: &quot;</span> + value);</span><br><span class="line">     &#125;)</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
</blockquote>
</li>
<li><p><strong>使用<code>TreeMap</code>时，如果<code>key</code>是自定义类型，必须定义比较大小的方法。</strong></p>
<blockquote>
<ul>
<li><strong>Method 1</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test1.java</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123; <span class="built_in">this</span>.name = name; <span class="built_in">this</span>.age = age; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> (Person)o;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.age == p.age) <span class="keyword">return</span> <span class="built_in">this</span>.name.compareTo(p.name);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> (<span class="built_in">this</span>.age &lt; p.age) ? -<span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Map&lt;Person, String&gt; map = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;Person, String&gt;();</span><br><span class="line">        map.put(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Tom&quot;</span>, <span class="number">20</span>), <span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        map.put(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Jana&quot;</span>, <span class="number">18</span>), <span class="string">&quot;world&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Method 2</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test2.java</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123; <span class="built_in">this</span>.name = name; <span class="built_in">this</span>.age = age; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Map&lt;Person, String&gt; map = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;Person, String&gt;</span><br><span class="line">            (<span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Person&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Person p1, Person p2)</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (p1.age == p2.age) <span class="keyword">return</span> p1.name.compareTo(p2.name);</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> (p1.age &lt; p2.age) ? -<span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        map.put(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Tom&quot;</span>, <span class="number">20</span>), <span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        map.put(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Jana&quot;</span>, <span class="number">18</span>), <span class="string">&quot;world&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p><strong>更多的细节</strong></p>
<ul>
<li><code>Vector</code>和<code>ArrayList</code>实现原理相同、功能相同，多数情况可以互用。区别为(1)<strong><code>Vector</code>线程安全，<code>ArrayList</code>重速度、线程不安全；</strong>(2)长度需增加时，<code>Vector</code>默认增长一倍，<code>ArrayList</code>默认增长50%。</li>
<li><code>Hashtable</code>和<code>HashMap</code>实现原理相同、功能相同，多数情况可以互用。区别为(1)<code>Hashtable</code>继承自<code>Dictionary</code>类，<code>HashMap</code>实现<code>Map</code>接口；(2)<strong><code>Hashtable</code>线程安全，<code>HashMap</code>线程不安全；</strong>(3)<code>Hashtable</code>不允许<code>null</code>值。</li>
<li><strong>关于<code>null</code></strong><ul>
<li>各集合中均可以放<code>null</code>值。</li>
<li><code>Set</code>的元素和<code>Map</code>的<code>key</code>中，<code>null</code>最多有一个。<strong>特别，<code>TreeMap</code>的<code>key</code>不能是<code>null</code>。</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="4-Iterator接口"><a href="#4-Iterator接口" class="headerlink" title="4. Iterator接口"></a>4. <code>Iterator</code>接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span>;</span><br><span class="line">    E <span class="title function_">next</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 遍历一个 List 的四种方式</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TraverseList</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">traverseByFor</span><span class="params">(List&lt;E&gt; list)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.size(); i++)</span><br><span class="line">            System.out.println(list.get(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">traverseByPoweredFor</span><span class="params">(List&lt;E&gt; list)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (E each : list)</span><br><span class="line">            System.out.println(each);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">traverseByIterator</span><span class="params">(List&lt;E&gt; list)</span> &#123;</span><br><span class="line">        Iterator&lt;E&gt; it = list.iterator();</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext())</span><br><span class="line">            System.out.println(it.next());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">traverseByForEach</span><span class="params">(List&lt;E&gt; list)</span> &#123;</span><br><span class="line">        list.forEach((e) -&gt; &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="九、异常（Exception）"><a href="#九、异常（Exception）" class="headerlink" title="九、异常（Exception）"></a>九、异常（Exception）</h2><h3 id="1-异常及其处理"><a href="#1-异常及其处理" class="headerlink" title="1. 异常及其处理"></a>1. 异常及其处理</h3><ul>
<li><p>异常是一个<strong>可以正确运行的程序</strong>在<strong>运行中可能发生的错误</strong>；异常处理就是将错误按类型和差别区分，对无法预知的错误进行<strong>捕获</strong>，并为之编写错误处理代码。</p>
</li>
<li><p><strong>异常的特点</strong></p>
<ul>
<li>偶然性</li>
<li>可预见性</li>
<li>严重性</li>
</ul>
</li>
<li><p><strong>Java 异常类</strong></p>
<ul>
<li><code>Throwable</code>是<code>Object</code>的直接子类，是<strong>所有异常类的父类</strong>，它位于<code>java.lang</code>包中。</li>
<li><code>Exception</code>继承自<code>Throwable</code>，它本身及其子类都是异常。</li>
<li><code>Error</code>也是<code>Throwable</code>的子类，它本身及其子类都由 Java 虚拟机生成并抛出，<strong>程序不做处理</strong>。</li>
</ul>
</li>
<li><p>异常的分类</p>
<ul>
<li><p><strong>受检异常：</strong>非<code>RuntimeException</code>异常和用户自己定义的未继承自<code>RuntimeException</code>的异常。此类异常必须用<code>try-catch</code>处理，或者该函数<code>throws</code>该异常。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java.lang.ClassNotFoundException</span><br><span class="line">java.lang.CloneNotSupportedException</span><br><span class="line">java.lang.IllegalAccessException</span><br><span class="line">java.lang.NoSuchMethodException</span><br><span class="line">java.io.IOException</span><br><span class="line">java.io.FileNotFoundException</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>非受检异常：</strong>由系统检测，用户程序可不做处理。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java.lang.ArithmeticException</span><br><span class="line">java.lang.ArrayStoreException</span><br><span class="line">java.lang.ClassCastException</span><br><span class="line">java.lang.IllegalArgumentException</span><br><span class="line">java.lang.NumberFormatException</span><br><span class="line">java.lang.IndexOutOfBoundsException</span><br><span class="line">java.lang.ArrayIndexOutOfBoundsException</span><br><span class="line">java.lang.StringIndexOutOfBoundsException</span><br><span class="line">java.lang.NullPointerException</span><br><span class="line">...</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p><strong>错误<code>Error</code>也是非受检的。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java.lang.LinkageError</span><br><span class="line">java.lang.NoClassDefFoundError</span><br><span class="line">java.lang.OutOfMemoryError</span><br><span class="line">java.lang.StackOverflowError</span><br><span class="line">java.lang.UnknownError</span><br><span class="line">java.lang.VirtualMachineError</span><br><span class="line">...</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h3 id="2-异常处理的抓抛模型"><a href="#2-异常处理的抓抛模型" class="headerlink" title="2. 异常处理的抓抛模型"></a>2. 异常处理的抓抛模型</h3><blockquote>
<ul>
<li><p>自定义异常 <code>Exceptions.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ExpA</span> <span class="keyword">extends</span> <span class="title class_">Exception</span> &#123;      <span class="comment">// 自定义异常可以继承自 Exception</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExpB</span> <span class="keyword">extends</span> <span class="title class_">Throwable</span> &#123;      <span class="comment">// 也可以继承自 Throwable</span></span><br><span class="line">	<span class="comment">// 对于继承自 Throwable 的异常，不能用 Exception 捕获。</span></span><br><span class="line">    <span class="comment">// 因为 Exception 是 Throwable 的子类。</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExpC</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line">    <span class="comment">// 自定义的非受检异常</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写可能抛出异常的类 <code>MyClass.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">throwMyException</span><span class="params">()</span> <span class="keyword">throws</span> ExpA &#123;  <span class="comment">// 声明函数抛出异常</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ExpA</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">throwMoreExceptions</span><span class="params">()</span> <span class="keyword">throws</span> ExpB, IOException, Exception &#123;</span><br><span class="line">                                           <span class="comment">// 声明函数抛出一系列异常</span></span><br><span class="line">        <span class="type">Random</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> r.nextInt(-<span class="number">1</span>, <span class="number">2</span>);      <span class="comment">// return &#123;-1, 0, 1&#125; randomly</span></span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">0</span>) </span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ExpB</span>();</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x == <span class="number">0</span>) </span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>();</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">throwUncheckedException</span><span class="params">(<span class="type">int</span> idx)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">10</span>];</span><br><span class="line">        arr[idx] = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">throwSelfDefUncheckedException</span><span class="params">()</span> &#123; <span class="comment">// 运行时异常不声明也不报错</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ExpC</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写测试类，用<code>try-catch(-finally)</code>处理异常 <code>Test.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">mc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mc.throwMyException();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExpA e) &#123;</span><br><span class="line">            e.printStackTrace(System.out);</span><br><span class="line">            System.out.println(<span class="string">&quot;catch ExpA&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mc.throwMoreExceptions();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExpB e) &#123;</span><br><span class="line">            e.printStackTrace(System.out);</span><br><span class="line">            System.out.println(<span class="string">&quot;catch ExpB&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace(System.out);</span><br><span class="line">            System.out.println(<span class="string">&quot;catch IOException&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;    </span><br><span class="line">            <span class="comment">// 更上层的异常类应放 catch 的后面，因为父类异常可以捕获子类异常</span></span><br><span class="line">            e.printStackTrace(System.out);</span><br><span class="line">            System.out.println(<span class="string">&quot;catch Exception&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mc.throwUncheckedException(<span class="number">3</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// 用父类 Exception 捕获子类 ArrayIndexOfOutBoundsException</span></span><br><span class="line">            System.out.println(<span class="string">&quot;in catch&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 无论是否抛出并捕获，finally 都会执行</span></span><br><span class="line">            System.out.println(<span class="string">&quot;in finally&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mc.throwUncheckedException(<span class="number">100</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            <span class="comment">// 用父类 Throwable 捕获子类 ArrayIndexOfOutBoundsException</span></span><br><span class="line">            System.out.println(<span class="string">&quot;in catch&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 无论是否抛出并捕获，finally 都会执行</span></span><br><span class="line">            System.out.println(<span class="string">&quot;in finally&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        mc.throwSelfDefUncheckedException();    <span class="comment">// 非受检异常，编译不报错</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<ul>
<li><p><strong>注意事项</strong></p>
<ul>
<li><p>一个函数可以不处理它产生的异常，而是通过<code>throws</code>关键字<strong>声明异常</strong>，从而使异常<strong>沿着调用层次向上传递</strong>，由调用它的函数处理。当传递到主函数<code>main</code>而没有处理异常，即<code>public static void main(String[] args) throws Exception &#123; &#125;</code>，则<strong>异常将交给系统处理</strong>。</p>
</li>
<li><p><strong>子类重写父类的函数时，不能抛出比父类函数抛出范围更大的异常。</strong></p>
<blockquote>
<p><strong>说明</strong></p>
<p>使用动多态时，通过父类的引用动态调用子类重写的函数。在调用处，由于使用了父类引用，故只会用<code>try-catch</code>处理父类抛出的异常类型，而<strong>无法预知</strong>子类可能产生的更多的异常类型，则会出错。</p>
</blockquote>
</li>
<li><p><code>finally</code>细节：<code>try</code>中抛出异常 - <code>catch</code>中<code>return</code> - <code>finally</code>中修改返回值</p>
<ul>
<li>此类情况下，程序会<strong>自动添加一个返回值类型的、名为var2的变量</strong>。在<code>catch</code>中的<code>return x;</code>语句会被换成<code>var2 = x;</code>。真正的<code>return</code>发生在<code>finally</code>执行之后，并且是<code>return var2;</code>。</li>
</ul>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;test1: in main, i = &quot;</span> + test1());</span><br><span class="line">     System.out.println();</span><br><span class="line">     System.out.println(<span class="string">&quot;test2: in main, s = &quot;</span> + test2());</span><br><span class="line">     System.out.println();</span><br><span class="line">     System.out.println(<span class="string">&quot;test3: in main, sb = &quot;</span> + test3());</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">test1</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">     <span class="comment">// int var2;</span></span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>();</span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">         <span class="keyword">return</span> i;				<span class="comment">// var2 = i; (var2 == i == 1)</span></span><br><span class="line">     &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">         i++;					<span class="comment">// i == 2;</span></span><br><span class="line">         System.out.println(<span class="string">&quot;test1: in finally, i = &quot;</span> + i);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">// return var2;</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">test2</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">     <span class="comment">// String var2;</span></span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>();</span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">         <span class="keyword">return</span> s;              <span class="comment">// var2 = s;</span></span><br><span class="line">     &#125; <span class="keyword">finally</span> &#123;                <span class="comment">// 字符串的 + 会 new 出一个新字符串</span></span><br><span class="line">         s += <span class="string">&quot; World&quot;</span>;         <span class="comment">// var2 -&gt; &quot;Hello&quot;; s -&gt; &quot;Hello World&quot;</span></span><br><span class="line">         System.out.println(<span class="string">&quot;test2: in finally, s = &quot;</span> + s);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">// return var2;</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> StringBuilder <span class="title function_">test3</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;Good&quot;</span>);</span><br><span class="line">     <span class="comment">// StringBuilder var2;</span></span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>();</span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">         <span class="keyword">return</span> sb;             <span class="comment">// var2 = s;</span></span><br><span class="line">     &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">         sb.append(<span class="string">&quot; Morning&quot;</span>); <span class="comment">// 不 new 新对象</span></span><br><span class="line">                                <span class="comment">// sb -&gt; &quot;Good Morning&quot; &lt;- var2</span></span><br><span class="line">         System.out.println(<span class="string">&quot;test3: in finally, sb = &quot;</span> + sb);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">// return var2;</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 输出</span></span><br><span class="line">test1: in <span class="keyword">finally</span>, i = <span class="number">2</span></span><br><span class="line">test1: in main, i = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">test2: in <span class="keyword">finally</span>, s = Hello World</span><br><span class="line">test2: in main, s = Hello</span><br><span class="line"></span><br><span class="line">test3: in <span class="keyword">finally</span>, sb = Good Morning</span><br><span class="line">test3: in main, sb = Good Morning</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
</li>
</ul>
<h2 id="十、Java-IO"><a href="#十、Java-IO" class="headerlink" title="十、Java IO"></a>十、Java IO</h2><h3 id="一-基本输入输出"><a href="#一-基本输入输出" class="headerlink" title="(一) 基本输入输出"></a>(一) 基本输入输出</h3><h4 id="1-命令行参数"><a href="#1-命令行参数" class="headerlink" title="1. 命令行参数"></a>1. 命令行参数</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommandLineArgsTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (String arg : args)</span><br><span class="line">            System.out.println(arg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; javac CommandLineArgsTest.java</span></span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; java CommandLineArgsTest arg0 arg1 arg2 ...</span></span><br><span class="line">arg0</span><br><span class="line">arg1</span><br><span class="line">arg2</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt;</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong><code>args[0]</code>从第一个有效参数开始，不包括程序名称。</strong></p>
</blockquote>
<h4 id="2-标准输入输出"><a href="#2-标准输入输出" class="headerlink" title="2. 标准输入输出"></a>2. 标准输入输出</h4><ul>
<li><p><strong>三个标准 I&#x2F;O 对象</strong></p>
<ul>
<li><strong>标准输入<code>System.in</code></strong></li>
<li><strong>标准输出<code>System.out</code></strong></li>
<li><strong>标准错误<code>System.err</code></strong></li>
</ul>
</li>
<li><p>两个标准输出对象都重载有<code>println</code>和<code>print</code>函数，支持基本类型和类类型的输出。<strong>打印类类型时，调用其<code>toString</code>函数。</strong></p>
</li>
<li><p><strong><code>java.util.Scanner</code>的使用</strong></p>
<ul>
<li><code>Scanner</code>通过<strong>分隔符模式</strong>将输入分解为标记（默认情况下为空白符匹配），然后可以使用不同的<code>next</code>函数获取其值。在获取前，一般需要判断是否还有要输入的数据。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;String&gt; <span class="title function_">readWord</span><span class="params">()</span> &#123;</span><br><span class="line">        ArrayList&lt;String&gt; ret = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">        <span class="keyword">while</span> (in.hasNext()) &#123;    <span class="comment">// 判断是否还有数据</span></span><br><span class="line">            ret.add(in.next());   <span class="comment">// 读取数据</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;String&gt; <span class="title function_">readLine</span><span class="params">()</span> &#123;</span><br><span class="line">        ArrayList&lt;String&gt; ret = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">        <span class="keyword">while</span> (in.hasNextLine()) &#123;</span><br><span class="line">            ret.add(in.nextLine());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">readAndShow</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">d</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (in.hasNextInt()) i = in.nextInt();</span><br><span class="line">        <span class="keyword">if</span> (in.hasNextDouble()) d = in.nextDouble();</span><br><span class="line">        <span class="keyword">if</span> (in.hasNext()) s = in.next();</span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;i = %d, d = %.2f, s = %s&quot;</span>, i, d, s));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="二-文件与数据流"><a href="#二-文件与数据流" class="headerlink" title="(二) 文件与数据流"></a>(二) 文件与数据流</h3><h4 id="1-输入输出流"><a href="#1-输入输出流" class="headerlink" title="1. 输入输出流"></a>1. 输入输出流</h4><ul>
<li><p><strong>概念：一组有顺序的、有起点和终点的字节集合。</strong></p>
<blockquote>
<ul>
<li>Java 程序不能直接操纵 I&#x2F;O 设备，而是在程序和设备之间加入一个中间介质，<strong>建立起数据通道传输数据</strong>，这就是流。</li>
<li><strong>流是数据传输的抽象表达，和具体设备无关。</strong>程序一旦建立起流，就可以不用关心起点或终点是何种设备。</li>
</ul>
</blockquote>
</li>
<li><p><strong>分类</strong></p>
<blockquote>
<ul>
<li><strong>输入数据流：只读不写</strong><ul>
<li>字节流：<code>InputStream</code>的子类</li>
<li>字符流：<code>Reader</code>的子类</li>
</ul>
</li>
<li><strong>输出数据流：只写不读</strong><ul>
<li>字节流：<code>OutputStream</code>的子类</li>
<li>字符流：<code>Writer</code>的子类</li>
</ul>
</li>
</ul>
</blockquote>
</li>
</ul>
<h4 id="2-文件类File"><a href="#2-文件类File" class="headerlink" title="2. 文件类File"></a>2. 文件类<code>File</code></h4><ul>
<li><p><code>File</code>类代表<strong>与平台无关的</strong>文件或目录。</p>
</li>
<li><p><code>File</code>类不涉及文件的具体内容，一般用于获得文件属性、新建和删除、重命名等。</p>
</li>
<li><p><strong><code>File</code>类常用操作</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 四种构造</span></span><br><span class="line">File(File parent, String child);</span><br><span class="line">File(String pathname);</span><br><span class="line">File(String parent, String child);</span><br><span class="line">File(URI uri);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件属性</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">canRead</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">canWrite</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">exists</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isFile</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isDirectory</span><span class="params">()</span>;</span><br><span class="line"><span class="type">long</span> <span class="title function_">length</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">setReadOnly</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件的创建、删除、重命名等</span></span><br><span class="line">String <span class="title function_">getName</span><span class="params">()</span>;</span><br><span class="line">String <span class="title function_">getPath</span><span class="params">()</span>;</span><br><span class="line">String <span class="title function_">getAbsolutePath</span><span class="params">()</span>;</span><br><span class="line">String <span class="title function_">getParent</span><span class="params">()</span>;</span><br><span class="line">File <span class="title function_">getParentFile</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">createNewFile</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">mkdir</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">mkdirs</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">delete</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">renameTo</span><span class="params">(File f)</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="3-I-x2F-O-流"><a href="#3-I-x2F-O-流" class="headerlink" title="3. I&#x2F;O 流"></a>3. I&#x2F;O 流</h4><blockquote>
<p><strong><code>InputStream</code></strong></p>
<ul>
<li><p><code>FileInputStream</code>用于从本地文件读取数据</p>
</li>
<li><p><code>PipedInputStream</code>用于从管道读取数据</p>
</li>
<li><p><code>FilterInputStream</code>的子类</p>
<ul>
<li><code>PushBackInputStream</code>可以将读出的数据回退到缓冲区中</li>
<li><code>BufferedInputStream</code>可指定缓冲区的大小进行构造</li>
<li><code>DataInputStream</code>可以读取基本数据类型</li>
<li><code>ByteArrayInputStream</code>可以将指定的<code>byte[]</code>作为缓冲区</li>
<li><code>SequencedInputStream</code>可以把多个<code>InputStream</code>对象转化为单个</li>
<li><code>ObjectInputStream</code>用于读取对象</li>
<li>……</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">read</span><span class="params">()</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="type">byte</span>[] buffer)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="type">byte</span>[] buffer, <span class="type">int</span> offset, <span class="type">int</span> length)</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">available</span><span class="params">()</span>;</span><br><span class="line"><span class="type">long</span> <span class="title function_">skip</span><span class="params">(<span class="type">long</span> n)</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">markSupported</span><span class="params">()</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">mark</span><span class="params">(<span class="type">int</span> readlimit)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong><code>OutputStream</code></strong></p>
<ul>
<li><p>基本成员与<code>InputStream</code>类似。</p>
</li>
<li><p>子类<code>PrintStream</code>支持多种格式的打印函数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> c)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">byte</span>[] buffer)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">byte</span>[] buffer, <span class="type">int</span> offset, <span class="type">int</span> length)</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong><code>Reader</code></strong></p>
<ul>
<li><p><strong>结构</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">          BufferedReader &lt;- LineNumberReader</span><br><span class="line">          CharArrayReader</span><br><span class="line">          StringReader</span><br><span class="line">Reader &lt;-    </span><br><span class="line">          InputStreamReader &lt;- FileReader</span><br><span class="line">          PipedReader</span><br><span class="line">          FilterReader &lt;- PushbackReader</span><br><span class="line">          ...</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>常用函数</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">read</span><span class="params">()</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="type">char</span>[] cbuf)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="type">char</span>[] cbuf, <span class="type">int</span> offset, <span class="type">int</span> length)</span>;</span><br><span class="line">String <span class="title function_">readLine</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">ready</span><span class="params">()</span>;</span><br><span class="line"><span class="type">long</span> <span class="title function_">skip</span><span class="params">(<span class="type">long</span> n)</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">markSupported</span><span class="params">()</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">mark</span><span class="params">(<span class="type">int</span> readAheadLimit)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong><code>Writer</code></strong></p>
<ul>
<li><p><strong>结构</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">          BufferedWriter</span><br><span class="line">          CharArrayWriter</span><br><span class="line">          StringWriter</span><br><span class="line">Writer &lt;- OutputStreamWriter &lt;- FileWriter</span><br><span class="line">          PrintWriter</span><br><span class="line">          PipedWriter</span><br><span class="line">          FilterWriter</span><br><span class="line">          ...</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>常用函数</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> c)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">char</span>[] cbuf)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">char</span>[] cbuf,l <span class="type">int</span> offset, <span class="type">int</span> length)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">write</span><span class="params">(String string)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">write</span><span class="params">(String string, <span class="type">int</span> offset, <span class="type">int</span> length)</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<ul>
<li><p><strong>过滤流</strong></p>
<ul>
<li><p><code>FilterInputStream</code>和<code>FilterOutputStream</code>是两个<strong>抽象类</strong>，都属于过滤流类。</p>
</li>
<li><p><strong>过滤流具有将流连接在一起的能力。</strong></p>
</li>
<li><p>过滤流实现了对象的<strong>同步机制</strong>，使得任一时刻只有一个线程访问它。</p>
</li>
<li><p>过滤流及其子类的构造通过可以接受一个 I&#x2F;O 流对象作为参数，从而为之加上一层<strong>过滤器</strong>。</p>
<blockquote>
<p><strong>举例说明：带缓冲的字节输入流<code>BufferedInputStream</code></strong></p>
<ul>
<li>此类接收一个<code>InputStream</code>对象作为自己的成员，从而使原输入流对象带上了缓冲，并提升了读取速度。</li>
<li>此类自带缓冲区，也可以<strong>调用重载的构造指定缓冲区大小</strong>，一般以本设备的内存页或磁盘块大小的整数倍为宜。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example.java</span></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Example</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;./a.jpeg&quot;</span>);       <span class="comment">// 一张很大的图片</span></span><br><span class="line">        <span class="type">int</span> c, cnt1 = <span class="number">0</span>, cnt2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (!f.exists()) System.exit(-<span class="number">1</span>);    <span class="comment">// 判断文件是否存在</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Date</span> <span class="variable">d1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();                <span class="comment">// 第一个时间点</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(f);</span><br><span class="line">            <span class="keyword">while</span> ((c = is.read()) != -<span class="number">1</span>) cnt1++;    <span class="comment">// 逐字节遍历</span></span><br><span class="line">            is.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.exit(-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Date</span> <span class="variable">d2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();                <span class="comment">// 第二个时间点</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">BufferedInputStream</span> <span class="variable">bis</span> </span><br><span class="line">                <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(f));</span><br><span class="line">            <span class="keyword">while</span> ((c = bis.read()) != -<span class="number">1</span>) cnt2++;   <span class="comment">// 逐字节遍历</span></span><br><span class="line">            bis.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.exit(-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Date</span> <span class="variable">d3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();                <span class="comment">// 第三个时间点</span></span><br><span class="line"></span><br><span class="line">        System.out.println</span><br><span class="line">            (<span class="string">&quot;InputStream: read &quot;</span> + cnt1 + <span class="string">&quot; bytes, using &quot;</span> +</span><br><span class="line">                (d2.getTime() - d1.getTime()) + <span class="string">&quot; ms.&quot;</span>);</span><br><span class="line">        System.out.println</span><br><span class="line">            (<span class="string">&quot;BufferedInputStream: read &quot;</span> + cnt2 + <span class="string">&quot; bytes, using &quot;</span> +</span><br><span class="line">                (d3.getTime() - d2.getTime()) + <span class="string">&quot; ms.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
</li>
<li><p><strong>数据流</strong></p>
<blockquote>
<p><strong>使用举例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Example</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">     <span class="type">byte</span>[] b = &#123;<span class="number">23</span>, <span class="number">90</span>, -<span class="number">1</span>, <span class="number">48</span>, -<span class="number">29</span>&#125;;</span><br><span class="line">     <span class="type">File</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;./date.dat&quot;</span>);</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         out.createNewFile();</span><br><span class="line"></span><br><span class="line">         <span class="type">DataOutputStream</span> <span class="variable">dos</span> </span><br><span class="line">             <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataOutputStream</span>(</span><br><span class="line">             		<span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(</span><br><span class="line">                         <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(out)));</span><br><span class="line"></span><br><span class="line">         dos.write(b);                        <span class="comment">// 写入五个字节</span></span><br><span class="line">         dos.writeBoolean(<span class="literal">true</span>);	             <span class="comment">// 写入一个布尔值</span></span><br><span class="line">         dos.writeDouble(<span class="number">3.14</span>);               <span class="comment">// 写入一个双精度浮点数</span></span><br><span class="line">         dos.writeUTF(<span class="string">&quot;你好，世界&quot;</span>);            <span class="comment">// 写入 UTF 编码的字符串</span></span><br><span class="line">         dos.writeChar(<span class="string">&#x27;s&#x27;</span>);                  <span class="comment">// 写入一个字符</span></span><br><span class="line">         dos.writeUTF(<span class="string">&quot;hello 数字123&quot;</span>);        <span class="comment">// 写入 UTF 编码的字符串</span></span><br><span class="line">         dos.close();</span><br><span class="line"></span><br><span class="line">         <span class="type">File</span> <span class="variable">in</span> <span class="operator">=</span> out;</span><br><span class="line">         <span class="type">DataInputStream</span> <span class="variable">dis</span> </span><br><span class="line">             <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataInputStream</span>(</span><br><span class="line">             	<span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(</span><br><span class="line">                     <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(in)));</span><br><span class="line"></span><br><span class="line">         System.out.println(<span class="string">&quot;available: &quot;</span> + dis.available());</span><br><span class="line">         	<span class="comment">// 可读字节数</span></span><br><span class="line">         System.out.println(<span class="string">&quot;mark supported? &quot;</span> + dis.markSupported());</span><br><span class="line">         	<span class="comment">// 是否可标记</span></span><br><span class="line">         dis.skip(<span class="number">3</span>);</span><br><span class="line">         	<span class="comment">// 跳过三个字节</span></span><br><span class="line">         System.out.println(<span class="string">&quot;=== skip 3 bytes, read ===\n&quot;</span> + </span><br><span class="line">                            dis.readByte() + <span class="string">&quot;, &quot;</span> + dis.readByte());</span><br><span class="line">         	<span class="comment">// 读取剩下两个字节的整数 48, -29</span></span><br><span class="line">         System.out.println(dis.readBoolean());</span><br><span class="line">         	<span class="comment">// 读取布尔类型 true</span></span><br><span class="line">         System.out.printf(<span class="string">&quot;%.2f\n&quot;</span>, dis.readDouble());</span><br><span class="line">         	<span class="comment">// 读取双精度浮点类型 3.14</span></span><br><span class="line">         dis.mark(<span class="number">1</span>);</span><br><span class="line">         	<span class="comment">// 在当前位置做标记</span></span><br><span class="line">         System.out.println(dis.readUTF());		<span class="comment">// 读取字符串 “你好，世界”</span></span><br><span class="line">         System.out.println(dis.readChar());		<span class="comment">// 读取字符 &#x27;c&#x27;</span></span><br><span class="line">         System.out.println(dis.readUTF());		<span class="comment">// 读取字符串 “hello 数字123”</span></span><br><span class="line">         dis.reset();	<span class="comment">// 回到标记位置</span></span><br><span class="line">         System.out.println(dis.readUTF());		<span class="comment">// 读取字符串 “你好，世界”</span></span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">         e.printStackTrace();</span><br><span class="line">         System.exit(-<span class="number">1</span>);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p><strong>回压流</strong></p>
<ul>
<li><p>一些情况下需要<strong>先读入一个或几个字节</strong>，判断输入流的属性。在正式读取时，再将<strong>全部内容</strong>读出。回压字节流<code>PushbackInputStream</code>提供的<code>unread</code>函数<strong>可以把读过的一个或几个字节回压到流中，也可以回压别的字节数据</strong>。</p>
</li>
<li><p><strong>构造</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">PushbackInputStream</span><span class="params">(InputStream in)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">PushbackInputStream</span><span class="params">(InputStream in, <span class="type">int</span> size)</span>;	<span class="comment">// size - 缓冲区大小</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong><code>unread</code>函数</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unread</span><span class="params">(<span class="type">int</span> b)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unread</span><span class="params">(<span class="type">byte</span>[] b)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unread</span><span class="params">(<span class="type">byte</span>[] b, <span class="type">int</span> off, <span class="type">int</span> len)</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>打印流</strong></p>
<ul>
<li><code>PrintStream</code>的对象<strong>建构在其他输出流的对象的基础上</strong>，所以其构造需要传入其他<code>OutputStream</code>的子类的对象作为参数。</li>
<li>标准输出<code>System.out</code>和标准错误<code>System.err</code>就是<code>PrintStream</code>实例的引用。</li>
<li><code>PrintStream</code>提供了<strong>重载</strong>的<code>write</code> <code>print</code> <code>println</code>函数用于输出。</li>
<li><code>PrintStream</code>的成员函数<strong>一般不抛异常</strong>，且当输出回车换行时，会<strong>自动强制刷缓存（flush）</strong>。</li>
</ul>
</li>
<li><p><strong>管道流</strong></p>
<ul>
<li>管道数据流一定是<strong>成对出现、相互连接</strong>的。管道主要用于<strong>线程间的通信</strong>。</li>
<li>管道输入流用管道输出流对象构造，管道输出流用管道输入流对象构造。如果连接了已经和别的管道连接的管道，会抛<code>IOException</code>。</li>
<li>管道流是<code>InputStream</code>或<code>OutputStream</code>的子类，因而可以连接到别的流。</li>
</ul>
</li>
</ul>
<h4 id="4-try-with-resource"><a href="#4-try-with-resource" class="headerlink" title="4. try with resource"></a>4. <code>try with resource</code></h4><ul>
<li><p>打开的流越多，<code>try-catch-finally</code>嵌套得越深。一般地，<code>finally</code>中进行<strong>流的关闭</strong>，这一功能可以用<code>try with resource</code>语句实现。</p>
</li>
<li><p>凡是实现了<code>java.lang.AutoCloseable</code>或<code>java.io.Closeable</code>接口的类，都可以作为<strong>资源（resource）</strong>。在<code>try</code>结束后，不论是否抛异常，资源都会被关闭，<strong>关闭的顺序与资源初始化的顺序相反</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ResourceA</span> <span class="keyword">implements</span> <span class="title class_">AutoCloseable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ResourceA&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;close ResourceA&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResourceB</span> <span class="keyword">implements</span> <span class="title class_">AutoCloseable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">f</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ResourceB&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;close ResourceB&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">ResourceA</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResourceA</span>();    <span class="comment">// 多个资源的初始化，用分号隔开</span></span><br><span class="line">             <span class="type">ResourceB</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResourceB</span>()) &#123;</span><br><span class="line">            a.f();</span><br><span class="line">            b.f();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="5-对象流和串行化"><a href="#5-对象流和串行化" class="headerlink" title="5. 对象流和串行化"></a>5. 对象流和串行化</h4><ul>
<li>使用对象流<code>ObjectInputStream</code>和<code>ObjectOutputStream</code>将从文件中读取某个类的对象或把某个类的对象存到文件中。</li>
<li><strong>能够进行串行化的类必须实现串行化接口<code>java.io.Serializable</code>。</strong>此接口中<strong>没有定义任何内容</strong>，仅用于告诉编译器这个类可以串行化。<strong>串行化（Serialize）指的是把自身转化为一系列字节以记录状态。</strong></li>
<li>有些类不能进行串行化，如<code>Thread</code>对象、<code>FileInputStream</code>对象等，<strong>因为其状态是暂时的</strong>。<strong>对不希望串行化的对象应使用<code>transient</code>关键字修饰。</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">double</span> d;</span><br><span class="line">    <span class="keyword">transient</span> String s1;   <span class="comment">// 不被串行化的成员</span></span><br><span class="line">    <span class="type">boolean</span> b;</span><br><span class="line">    String s2;</span><br><span class="line">    MyClass(<span class="type">int</span> i, <span class="type">double</span> d, String s1, <span class="type">boolean</span> b, String s2) &#123;</span><br><span class="line">        <span class="built_in">this</span>.i = i; <span class="built_in">this</span>.d = d; <span class="built_in">this</span>.s1 = s1; <span class="built_in">this</span>.b = b; <span class="built_in">this</span>.s2 = s2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;i = &quot;</span> + i + <span class="string">&quot;, d = &quot;</span> + d + </span><br><span class="line">                          <span class="string">&quot;, s1 = &quot;</span> + s1 + <span class="string">&quot;, b = &quot;</span> + </span><br><span class="line">                          b + <span class="string">&quot;, s2 = &quot;</span> + s2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">mc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>(<span class="number">10</span>, <span class="number">3.14</span>, <span class="string">&quot;hello&quot;</span>, <span class="literal">true</span>, <span class="string">&quot;world&quot;</span>);</span><br><span class="line">        <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;./class.dat&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            f.createNewFile();</span><br><span class="line"></span><br><span class="line">            <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> </span><br><span class="line">                <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(</span><br><span class="line">                	<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(f));  <span class="comment">// 创建对象输出流</span></span><br><span class="line">            oos.writeObject(mc);               <span class="comment">// 将对象 mc 写入文件</span></span><br><span class="line">            oos.close();</span><br><span class="line"></span><br><span class="line">            <span class="type">ObjectInputStream</span> <span class="variable">ois</span> </span><br><span class="line">                <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(</span><br><span class="line">                	<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(f));   <span class="comment">// 创建对象输入流</span></span><br><span class="line">            <span class="type">MyClass</span> <span class="variable">mc1</span> <span class="operator">=</span> (MyClass)ois.readObject(); </span><br><span class="line">                                              <span class="comment">// 从文件读取对象(readObject 返回 Object)</span></span><br><span class="line">            ois.close();</span><br><span class="line"></span><br><span class="line">            System.out.println(mc1);  <span class="comment">// s1 未被串行化，故会输出默认值 s1 = null</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Chou</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2023/01/07/OOP/">http://example.com/2023/01/07/OOP/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Riccardo's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://github.com/Pan-Pan-Pan/AssetsForBlog/tree/main/global/background.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1"><span class="toc-text">面向对象的程序设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81Java-%E8%AF%AD%E8%A8%80"><span class="toc-text">一、Java 语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Java-%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">1. Java 的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Java-%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-text">2. Java 虚拟机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6"><span class="toc-text">3. 垃圾回收机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-JRE-%E5%92%8C-JDK"><span class="toc-text">4. JRE 和 JDK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Java-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">5. Java 关键字</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1"><span class="toc-text">二、类和对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%B1%BB"><span class="toc-text">1. 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-text">2. 类和对象的关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B6%88%E6%81%AF"><span class="toc-text">3. 消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%88%90%E5%91%98"><span class="toc-text">4. 成员</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%B1%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-text">5. 类之间的关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%B0%81%E8%A3%85"><span class="toc-text">三、封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">1. 数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%98%E9%87%8F"><span class="toc-text">2. 变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%B1%BB%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-text">3. 类的定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%94%9F%E6%88%90%E5%92%8C%E6%B8%85%E9%99%A4"><span class="toc-text">4. 对象的生成和清除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-static"><span class="toc-text">5. static</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="toc-text">6. 访问控制修饰符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%BB%A7%E6%89%BF"><span class="toc-text">四、继承</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Java-%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-text">1. Java 的继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AD%90%E7%B1%BB%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-text">2. 子类的构造函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BB%A7%E6%89%BF%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F%E9%9A%90%E8%97%8F"><span class="toc-text">3. 继承中的变量隐藏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%87%BD%E6%95%B0%E7%9A%84%E9%87%8D%E5%86%99%EF%BC%88Override%EF%BC%89"><span class="toc-text">4. 函数的重写（Override）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%A4%9A%E6%80%81%EF%BC%88Polymorphism%EF%BC%89"><span class="toc-text">五、多态（Polymorphism）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%9A%E6%80%81%E6%80%A7"><span class="toc-text">1. 多态性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%9D%99%E5%A4%9A%E6%80%81"><span class="toc-text">2. 静多态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8A%A8%E5%A4%9A%E6%80%81"><span class="toc-text">3. 动多态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8A%BD%E8%B1%A1%EF%BC%88Abstract%EF%BC%89"><span class="toc-text">4. 抽象（Abstract）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%8E%A5%E5%8F%A3%EF%BC%88Interface%EF%BC%89"><span class="toc-text">六、接口（Interface）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-text">1. 接口的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">2. 接口的实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%8E%A5%E5%8F%A3%E5%9B%9E%E8%B0%83"><span class="toc-text">3. 接口回调</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8E%A5%E5%8F%A3%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-text">4. 接口的继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-instanceof"><span class="toc-text">5. instanceof</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%B1%BB%E7%9A%84%E8%BF%9B%E9%98%B6%E8%AE%BE%E8%AE%A1"><span class="toc-text">七、类的进阶设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80-OOP-%E7%9A%84%E8%8B%A5%E5%B9%B2%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99"><span class="toc-text">(一) OOP 的若干基本原则</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-UML-%E5%9B%BE"><span class="toc-text">1.  UML 图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%9D%A2%E5%90%91%E6%8A%BD%E8%B1%A1%E5%8E%9F%E5%88%99%EF%BC%9A%E9%9D%A2%E5%90%91%E6%8E%A5%E5%8F%A3%E7%9A%84%E7%BC%96%E7%A8%8B"><span class="toc-text">2. 面向抽象原则：面向接口的编程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%BC%98%E5%85%88%E4%BD%BF%E7%94%A8%E7%BB%84%E5%90%88%E5%B0%91%E7%94%A8%E7%BB%A7%E6%89%BF%E5%8E%9F%E5%88%99"><span class="toc-text">3. 优先使用组合少用继承原则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%9B%B4%E5%A4%9A%E7%9A%84%E5%8E%9F%E5%88%99"><span class="toc-text">4. 更多的原则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C-%E5%87%A0%E4%B8%AA%E9%87%8D%E8%A6%81%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="toc-text">(二) 几个重要的设计模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="toc-text">1. 原型模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F"><span class="toc-text">2. 策略模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-text">3. 访问者模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F"><span class="toc-text">4. 装饰模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="toc-text">5. 适配器模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F"><span class="toc-text">6. 责任链模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%EF%BC%88%E9%97%A8%E9%9D%A2%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">7. 外观模式（门面模式）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="toc-text">8. 工厂模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%EF%BC%9A%E4%B8%BA%E4%BA%A7%E5%93%81%E5%88%9B%E5%BB%BA%E5%B7%A5%E5%8E%82%E7%B1%BB%EF%BC%8C%E5%AE%A2%E6%88%B7%E8%B0%83%E7%94%A8%E5%B7%A5%E5%8E%82%E7%9A%84%E5%87%BD%E6%95%B0%E8%8E%B7%E5%BE%97%E4%BA%A7%E5%93%81%E3%80%82"><span class="toc-text">简单工厂：为产品创建工厂类，客户调用工厂的函数获得产品。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95"><span class="toc-text">工厂方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%EF%BC%9A%E6%9B%B4%E9%AB%98%E5%B1%82%E6%AC%A1%E6%8A%BD%E8%B1%A1%E7%9A%84%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95"><span class="toc-text">抽象工厂：更高层次抽象的工厂方法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E7%9B%91%E5%90%AC%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">9. 观察者模式（监听模式）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6"><span class="toc-text">八、集合框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E6%A6%82%E8%BF%B0"><span class="toc-text">1. 集合框架概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Collection%E6%8E%A5%E5%8F%A3"><span class="toc-text">2. Collection接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Map%E6%8E%A5%E5%8F%A3"><span class="toc-text">3. Map接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Iterator%E6%8E%A5%E5%8F%A3"><span class="toc-text">4. Iterator接口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%BC%82%E5%B8%B8%EF%BC%88Exception%EF%BC%89"><span class="toc-text">九、异常（Exception）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BC%82%E5%B8%B8%E5%8F%8A%E5%85%B6%E5%A4%84%E7%90%86"><span class="toc-text">1. 异常及其处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E7%9A%84%E6%8A%93%E6%8A%9B%E6%A8%A1%E5%9E%8B"><span class="toc-text">2. 异常处理的抓抛模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81Java-IO"><span class="toc-text">十、Java IO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80-%E5%9F%BA%E6%9C%AC%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA"><span class="toc-text">(一) 基本输入输出</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0"><span class="toc-text">1. 命令行参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA"><span class="toc-text">2. 标准输入输出</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C-%E6%96%87%E4%BB%B6%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="toc-text">(二) 文件与数据流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%B5%81"><span class="toc-text">1. 输入输出流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%96%87%E4%BB%B6%E7%B1%BBFile"><span class="toc-text">2. 文件类File</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-I-x2F-O-%E6%B5%81"><span class="toc-text">3. I&#x2F;O 流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-try-with-resource"><span class="toc-text">4. try with resource</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%AF%B9%E8%B1%A1%E6%B5%81%E5%92%8C%E4%B8%B2%E8%A1%8C%E5%8C%96"><span class="toc-text">5. 对象流和串行化</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Chou</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div></div></body></html>